<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>srsRAN: srsue/hdr/phy/nr/state.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">srsRAN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dc7737dc64ff95bba2092635e67df1a3.html">srsue</a></li><li class="navelem"><a class="el" href="dir_9b2f189a0d30bf584ccda766df6e09eb.html">hdr</a></li><li class="navelem"><a class="el" href="dir_7e19145ce5df4fe06af58ec35573677c.html">phy</a></li><li class="navelem"><a class="el" href="dir_bdac550c8e05a6c9d0eb21b1c6565ab6.html">nr</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">state.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="state_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#ifndef SRSRAN_STATE_H</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#define SRSRAN_STATE_H</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;../phy_metrics.h&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="circular__array_8h.html">srsran/adt/circular_array.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="common_2common_8h.html">srsran/common/common.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ue__nr__interfaces_8h.html">srsran/interfaces/ue_nr_interfaces.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="srsran_8h.html">srsran/srsran.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;mutex&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacesrsue.html">srsue</a> {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacesrsran.html#a4b0dc9d2ff01ae471b0192925a565b7da0ab3e5d0801aea3f3758bcbd812e8f10">nr</a> {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html">   37</a></span>&#160;<span class="keyword">class </span><a class="code" href="classsrsue_1_1nr_1_1state.html">state</a></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html">   40</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html">pending_ul_grant_t</a> {</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#a1973a1bc5d5c6f4cb1f9e6e8e4e53f99">   41</a></span>&#160;    <span class="keywordtype">bool</span>                <a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#a1973a1bc5d5c6f4cb1f9e6e8e4e53f99">enable</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#a12692e4a938e406661801871d9563fc4">   42</a></span>&#160;    uint32_t            <a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#a12692e4a938e406661801871d9563fc4">pid</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#af4dc6397d3c1c1968235a8c006a55bef">   43</a></span>&#160;    <a class="code" href="structSRSRAN__API.html">srsran_sch_cfg_nr_t</a> <a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#af4dc6397d3c1c1968235a8c006a55bef">sch_cfg</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  };</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a2234f49a90ddaf128c2cbca8c17ab588">   45</a></span>&#160;  <a class="code" href="classsrsran_1_1circular__array.html">srsran::circular_array&lt;pending_ul_grant_t, TTIMOD_SZ&gt;</a> <a class="code" href="classsrsue_1_1nr_1_1state.html#a2234f49a90ddaf128c2cbca8c17ab588">pending_ul_grant</a> = {};</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a409be00b694fce56bc1847e76826db15">   46</a></span>&#160;  <span class="keyword">mutable</span> std::mutex                                    <a class="code" href="classsrsue_1_1nr_1_1state.html#a409be00b694fce56bc1847e76826db15">pending_ul_grant_mutex</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html">   48</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html">pending_dl_grant_t</a> {</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#aecec2d1232fc364871e92eb2da835013">   49</a></span>&#160;    <span class="keywordtype">bool</span>                       <a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#aecec2d1232fc364871e92eb2da835013">enable</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a0a9295bbef96fa4a6087191580274f24">   50</a></span>&#160;    uint32_t                   <a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a0a9295bbef96fa4a6087191580274f24">pid</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a18e67c345bff75c48423d71600bf9719">   51</a></span>&#160;    <a class="code" href="structSRSRAN__API.html">srsran_sch_cfg_nr_t</a>        <a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a18e67c345bff75c48423d71600bf9719">sch_cfg</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a6bc98e21ab1f3a613ac02ff99ad3bda9">   52</a></span>&#160;    <a class="code" href="structsrsran__harq__ack__resource__t.html">srsran_harq_ack_resource_t</a> <a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a6bc98e21ab1f3a613ac02ff99ad3bda9">ack_resource</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  };</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a3e75521102a6ea3bfdb796a401f26ebd">   54</a></span>&#160;  <a class="code" href="classsrsran_1_1circular__array.html">srsran::circular_array&lt;pending_dl_grant_t, TTIMOD_SZ&gt;</a> <a class="code" href="classsrsue_1_1nr_1_1state.html#a3e75521102a6ea3bfdb796a401f26ebd">pending_dl_grant</a> = {};</div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#abb7424b02a0e5298fe56493d93e5af79">   55</a></span>&#160;  <span class="keyword">mutable</span> std::mutex                                    <a class="code" href="classsrsue_1_1nr_1_1state.html#abb7424b02a0e5298fe56493d93e5af79">pending_dl_grant_mutex</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a2ec243a32a91ddb9335831bd23d18f23">   57</a></span>&#160;  <a class="code" href="classsrsran_1_1circular__array.html">srsran::circular_array&lt;srsran_pdsch_ack_nr_t, TTIMOD_SZ&gt;</a> <a class="code" href="classsrsue_1_1nr_1_1state.html#a2ec243a32a91ddb9335831bd23d18f23">pending_ack</a> = {};</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a83c09ac445dd136d6049eb4d6989685a">   58</a></span>&#160;  <span class="keyword">mutable</span> std::mutex                                       <a class="code" href="classsrsue_1_1nr_1_1state.html#a83c09ac445dd136d6049eb4d6989685a">pending_ack_mutex</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a65c22efd981cab343ae01b09ab81147d">   61</a></span>&#160;  <a class="code" href="structsrsue_1_1info__metrics__t.html">info_metrics_t</a>     <a class="code" href="classsrsue_1_1nr_1_1state.html#a65c22efd981cab343ae01b09ab81147d">info_metrics</a> = {};</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#af367acfa7c9f61585e7511aa5246a3f6">   62</a></span>&#160;  <a class="code" href="structsrsue_1_1sync__metrics__t.html">sync_metrics_t</a>     <a class="code" href="classsrsue_1_1nr_1_1state.html#af367acfa7c9f61585e7511aa5246a3f6">sync_metrics</a> = {};</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a11dc9f4b7025073bb21bffbd55448428">   63</a></span>&#160;  <a class="code" href="structsrsue_1_1ch__metrics__t.html">ch_metrics_t</a>       <a class="code" href="classsrsue_1_1nr_1_1state.html#a11dc9f4b7025073bb21bffbd55448428">ch_metrics</a>   = {};</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a995b7643d22b218f30b86f5e6d5f559b">   64</a></span>&#160;  <a class="code" href="structsrsue_1_1dl__metrics__t.html">dl_metrics_t</a>       <a class="code" href="classsrsue_1_1nr_1_1state.html#a995b7643d22b218f30b86f5e6d5f559b">dl_metrics</a>   = {};</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#ae9d8a85c42551eb2446a0e8a010712f3">   65</a></span>&#160;  <a class="code" href="structsrsue_1_1ul__metrics__t.html">ul_metrics_t</a>       <a class="code" href="classsrsue_1_1nr_1_1state.html#ae9d8a85c42551eb2446a0e8a010712f3">ul_metrics</a>   = {};</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a138942764c8e8ba32a7ec7e3ebd6667e">   66</a></span>&#160;  <span class="keyword">mutable</span> std::mutex <a class="code" href="classsrsue_1_1nr_1_1state.html#a138942764c8e8ba32a7ec7e3ebd6667e">metrics_mutex</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a418e6cae3a9d919f0b7321f9375a0183">   69</a></span>&#160;  std::mutex                                                                  <a class="code" href="classsrsue_1_1nr_1_1state.html#a418e6cae3a9d919f0b7321f9375a0183">csi_measurements_mutex</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#aa8849a969d7ce49d7b3e5f43d57d3ce1">   70</a></span>&#160;  std::array&lt;srsran_csi_channel_measurements_t, SRSRAN_CSI_MAX_NOF_RESOURCES&gt; <a class="code" href="classsrsue_1_1nr_1_1state.html#aa8849a969d7ce49d7b3e5f43d57d3ce1">csi_measurements</a> = {};</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#afcd752ab157b166ab7df7d24fb88e6ae">   73</a></span>&#160;  <span class="keyword">mutable</span> std::mutex            <a class="code" href="classsrsue_1_1nr_1_1state.html#afcd752ab157b166ab7df7d24fb88e6ae">trs_measurements_mutex</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#ac7dd5bcc67a6e59ad73f8b75071fcf19">   74</a></span>&#160;  <a class="code" href="structSRSRAN__API.html">srsran_csi_trs_measurements_t</a> <a class="code" href="classsrsue_1_1nr_1_1state.html#ac7dd5bcc67a6e59ad73f8b75071fcf19">trs_measurements</a> = {};</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a27163182ff61aa6a8fad2297f8912916">   77</a></span>&#160;  std::atomic&lt;float&gt; <a class="code" href="classsrsue_1_1nr_1_1state.html#a27163182ff61aa6a8fad2297f8912916">ul_ext_cfo_hz</a> = {0.0f};</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#aeb03433bdd0494f672bebded74a38c03">   82</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#aeb03433bdd0494f672bebded74a38c03">reset_metrics_</a>()</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#af367acfa7c9f61585e7511aa5246a3f6">sync_metrics</a>.<a class="code" href="structsrsue_1_1sync__metrics__t.html#afd4ddbfa1006779906272d701ea2cd47">reset</a>();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#a11dc9f4b7025073bb21bffbd55448428">ch_metrics</a>.<a class="code" href="structsrsue_1_1ch__metrics__t.html#a39c926a02488425369c35c514a5aff92">reset</a>();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#a995b7643d22b218f30b86f5e6d5f559b">dl_metrics</a>.<a class="code" href="structsrsue_1_1dl__metrics__t.html#a25b448eee03a427fe8d32ad69e8293eb">reset</a>();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#ae9d8a85c42551eb2446a0e8a010712f3">ul_metrics</a>.<a class="code" href="structsrsue_1_1ul__metrics__t.html#ac5dae2a30bb6d516b4348a566312ad34">reset</a>();</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a8832b1e822846d912c9d001ede7172c5">   91</a></span>&#160;  <a class="code" href="classsrsue_1_1mac__interface__phy__nr.html">mac_interface_phy_nr</a>* <a class="code" href="classsrsue_1_1nr_1_1state.html#a8832b1e822846d912c9d001ede7172c5">stack</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a5ec642b321a3aa3f2865d4be6455260b">   94</a></span>&#160;  <a class="code" href="structsrsue_1_1phy__args__nr__t.html">phy_args_nr_t</a> <a class="code" href="classsrsue_1_1nr_1_1state.html#a5ec642b321a3aa3f2865d4be6455260b">args</a> = {};</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a77f048297b136affc11f60b3b5174ced">   97</a></span>&#160;  <a class="code" href="classsrsran_1_1tti__semaphore.html">srsran::tti_semaphore&lt;void*&gt;</a> <a class="code" href="classsrsue_1_1nr_1_1state.html#a77f048297b136affc11f60b3b5174ced">dl_ul_semaphore</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a5a3e3250451afcba94ca4851a375e8bc">   99</a></span>&#160;  <a class="code" href="classsrsue_1_1nr_1_1state.html#a5a3e3250451afcba94ca4851a375e8bc">state</a>()</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// Hard-coded values, this should be set when the measurements take place</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#aa8849a969d7ce49d7b3e5f43d57d3ce1">csi_measurements</a>[0].K_csi_rs  = 1;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#aa8849a969d7ce49d7b3e5f43d57d3ce1">csi_measurements</a>[0].nof_ports = 1;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#aa8849a969d7ce49d7b3e5f43d57d3ce1">csi_measurements</a>[1].K_csi_rs  = 4;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#aa8849a969d7ce49d7b3e5f43d57d3ce1">csi_measurements</a>[1].nof_ports = 1;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#af403ff4ff52d7fe9af7f20f3f8096106">  114</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#af403ff4ff52d7fe9af7f20f3f8096106">set_ul_pending_grant</a>(<span class="keyword">const</span> <a class="code" href="structsrsran_1_1phy__cfg__nr__t.html">srsran::phy_cfg_nr_t</a>&amp; cfg,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                            <span class="keyword">const</span> <a class="code" href="structSRSRAN__API.html">srsran_slot_cfg_t</a>&amp;    slot_rx,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                            <span class="keyword">const</span> <a class="code" href="structSRSRAN__API.html">srsran_dci_ul_nr_t</a>&amp;   dci_ul)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// Convert UL DCI to grant</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="structSRSRAN__API.html">srsran_sch_cfg_nr_t</a> pusch_cfg = {};</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">if</span> (not cfg.<a class="code" href="structsrsran_1_1phy__cfg__nr__t.html#a1d7eb497cdfa3a514c6dd9625dbec358">get_pusch_cfg</a>(slot_rx, dci_ul, pusch_cfg)) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      std::array&lt;char, 512&gt; str;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <a class="code" href="dci__nr_8h.html#a2e81ebc47012bd4cb7031936defa07ce">srsran_dci_ul_nr_to_str</a>(NULL, &amp;dci_ul, str.<a class="code" href="structSRSRAN__API.html#ad3705c1da241123beac2fba29b8c0af5">data</a>(), str.<a class="code" href="structSRSRAN__API.html#a02b5b2bb1beadc3e915f6b51b86970a6">size</a>());</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <a class="code" href="debug_8h.html#aff62ee963c9ecc544894676b842e9491">ERROR</a>(<span class="stringliteral">&quot;Computing UL grant %s&quot;</span>, str.data());</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// Calculate Transmit TTI</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    uint32_t tti_tx = <a class="code" href="common_2common_8h.html#a54bfee4588ec6db455ac4ed8aeca95e3">TTI_ADD</a>(slot_rx.<a class="code" href="structSRSRAN__API.html#a4d6cbb09d61d0ab7dbd8dc3a5160efd2">idx</a>, pusch_cfg.<a class="code" href="structSRSRAN__API.html#a8198636af20c946c582c87bb21b8113e">grant</a>.<a class="code" href="structSRSRAN__API.html#a2174b300cb11c9b3c9820e60956cbafb">k</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// Scope mutex to protect read/write the list</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a409be00b694fce56bc1847e76826db15">pending_ul_grant_mutex</a>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// Save entry</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html">pending_ul_grant_t</a>&amp; pending_grant = <a class="code" href="classsrsue_1_1nr_1_1state.html#a2234f49a90ddaf128c2cbca8c17ab588">pending_ul_grant</a>[tti_tx];</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#af4dc6397d3c1c1968235a8c006a55bef">sch_cfg</a>             = pusch_cfg;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#a12692e4a938e406661801871d9563fc4">pid</a>                 = dci_ul.<a class="code" href="structSRSRAN__API.html#a9dfe21caecd546922afb7435f6155e69">pid</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#a1973a1bc5d5c6f4cb1f9e6e8e4e53f99">enable</a>              = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#aaaa794f95b78e973825b396484f2dc20">  147</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#aaaa794f95b78e973825b396484f2dc20">get_ul_pending_grant</a>(uint32_t tti_tx, <a class="code" href="structSRSRAN__API.html">srsran_sch_cfg_nr_t</a>&amp; pusch_cfg, uint32_t&amp; pid)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// Scope mutex to protect read/write the list</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a409be00b694fce56bc1847e76826db15">pending_ul_grant_mutex</a>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// Select entry</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html">pending_ul_grant_t</a>&amp; pending_grant = <a class="code" href="classsrsue_1_1nr_1_1state.html#a2234f49a90ddaf128c2cbca8c17ab588">pending_ul_grant</a>[tti_tx];</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// If the entry is not active, just return</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span> (!pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#a1973a1bc5d5c6f4cb1f9e6e8e4e53f99">enable</a>) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// Load shared channel configuration and PID</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    pusch_cfg = pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#af4dc6397d3c1c1968235a8c006a55bef">sch_cfg</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    pid       = pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#a12692e4a938e406661801871d9563fc4">pid</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// Reset entry</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#a1973a1bc5d5c6f4cb1f9e6e8e4e53f99">enable</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a576a89f5ef2142a0100290be9ae1a813">  177</a></span>&#160;  <a class="code" href="classsrsue_1_1nr_1_1state.html#a576a89f5ef2142a0100290be9ae1a813">set_dl_pending_grant</a>(<span class="keyword">const</span> <a class="code" href="structsrsran_1_1phy__cfg__nr__t.html">srsran::phy_cfg_nr_t</a>&amp; cfg, <span class="keyword">const</span> <a class="code" href="structSRSRAN__API.html">srsran_slot_cfg_t</a>&amp; slot, <span class="keyword">const</span> <a class="code" href="structSRSRAN__API.html">srsran_dci_dl_nr_t</a>&amp; dci_dl)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// Convert DL DCI to grant</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="structSRSRAN__API.html">srsran_sch_cfg_nr_t</a> <a class="code" href="pdsch__ue_8c.html#af56ee4ac13bcfa2f70ad4cbb1d506422">pdsch_cfg</a> = {};</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (not cfg.<a class="code" href="structsrsran_1_1phy__cfg__nr__t.html#ac728ba697476cb9fc8b2fd22aa2091f3">get_pdsch_cfg</a>(slot, dci_dl, <a class="code" href="pdsch__ue_8c.html#af56ee4ac13bcfa2f70ad4cbb1d506422">pdsch_cfg</a>)) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      std::array&lt;char, 512&gt; str;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <a class="code" href="dci__nr_8h.html#ab92800edbdf3d678ea6fe90a5c538b0f">srsran_dci_dl_nr_to_str</a>(NULL, &amp;dci_dl, str.<a class="code" href="structSRSRAN__API.html#ad3705c1da241123beac2fba29b8c0af5">data</a>(), str.<a class="code" href="structSRSRAN__API.html#a02b5b2bb1beadc3e915f6b51b86970a6">size</a>());</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <a class="code" href="debug_8h.html#aff62ee963c9ecc544894676b842e9491">ERROR</a>(<span class="stringliteral">&quot;Computing DL grant %s&quot;</span>, str.data());</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// Calculate DL DCI to PDSCH ACK resource</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="structsrsran__harq__ack__resource__t.html">srsran_harq_ack_resource_t</a> ack_resource = {};</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">if</span> (not cfg.<a class="code" href="structsrsran_1_1phy__cfg__nr__t.html#ad9fef5820d100dfc5665a6acc25a67d7">get_pdsch_ack_resource</a>(dci_dl, ack_resource)) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <a class="code" href="debug_8h.html#aff62ee963c9ecc544894676b842e9491">ERROR</a>(<span class="stringliteral">&quot;Computing UL ACK resource&quot;</span>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// Calculate Receive TTI</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    uint32_t tti_rx = <a class="code" href="common_2common_8h.html#a54bfee4588ec6db455ac4ed8aeca95e3">TTI_ADD</a>(slot.<a class="code" href="structSRSRAN__API.html#a4d6cbb09d61d0ab7dbd8dc3a5160efd2">idx</a>, <a class="code" href="pdsch__ue_8c.html#af56ee4ac13bcfa2f70ad4cbb1d506422">pdsch_cfg</a>.<a class="code" href="structSRSRAN__API.html#a8198636af20c946c582c87bb21b8113e">grant</a>.<a class="code" href="structSRSRAN__API.html#a2174b300cb11c9b3c9820e60956cbafb">k</a>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// Scope mutex to protect read/write the list</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#abb7424b02a0e5298fe56493d93e5af79">pending_dl_grant_mutex</a>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// Save entry</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html">pending_dl_grant_t</a>&amp; pending_grant = <a class="code" href="classsrsue_1_1nr_1_1state.html#a3e75521102a6ea3bfdb796a401f26ebd">pending_dl_grant</a>[tti_rx];</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a18e67c345bff75c48423d71600bf9719">sch_cfg</a>             = <a class="code" href="pdsch__ue_8c.html#af56ee4ac13bcfa2f70ad4cbb1d506422">pdsch_cfg</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a6bc98e21ab1f3a613ac02ff99ad3bda9">ack_resource</a>        = ack_resource;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a0a9295bbef96fa4a6087191580274f24">pid</a>                 = dci_dl.<a class="code" href="structSRSRAN__API.html#a9dfe21caecd546922afb7435f6155e69">pid</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#aecec2d1232fc364871e92eb2da835013">enable</a>              = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a2ad2ed48275d0ea5cae9195e9f5f8a57">  218</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a2ad2ed48275d0ea5cae9195e9f5f8a57">get_dl_pending_grant</a>(uint32_t                    tti_rx,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                            <a class="code" href="structSRSRAN__API.html">srsran_sch_cfg_nr_t</a>&amp;        <a class="code" href="pdsch__ue_8c.html#af56ee4ac13bcfa2f70ad4cbb1d506422">pdsch_cfg</a>,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                            <a class="code" href="structsrsran__harq__ack__resource__t.html">srsran_harq_ack_resource_t</a>&amp; ack_resource,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                            uint32_t&amp;                   pid)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// Scope mutex to protect read/write the list</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#abb7424b02a0e5298fe56493d93e5af79">pending_dl_grant_mutex</a>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// Select entry</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html">pending_dl_grant_t</a>&amp; pending_grant = <a class="code" href="classsrsue_1_1nr_1_1state.html#a3e75521102a6ea3bfdb796a401f26ebd">pending_dl_grant</a>[tti_rx];</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// If the entry is not active, just return</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">if</span> (!pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#aecec2d1232fc364871e92eb2da835013">enable</a>) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// Load shared channel configuration and resource</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="pdsch__ue_8c.html#af56ee4ac13bcfa2f70ad4cbb1d506422">pdsch_cfg</a>    = pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a18e67c345bff75c48423d71600bf9719">sch_cfg</a>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    ack_resource = pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a6bc98e21ab1f3a613ac02ff99ad3bda9">ack_resource</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    pid          = pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a0a9295bbef96fa4a6087191580274f24">pid</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// Reset entry</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    pending_grant.<a class="code" href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#aecec2d1232fc364871e92eb2da835013">enable</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a1645a12dc0a979af75a9aaf76940e70c">  250</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a1645a12dc0a979af75a9aaf76940e70c">set_pending_ack</a>(<span class="keyword">const</span> uint32_t&amp; tti_rx, <span class="keyword">const</span> <a class="code" href="structsrsran__harq__ack__resource__t.html">srsran_harq_ack_resource_t</a>&amp; ack_resource, <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; crc_ok)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// Calculate Receive TTI</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    uint32_t tti_tx = <a class="code" href="common_2common_8h.html#a54bfee4588ec6db455ac4ed8aeca95e3">TTI_ADD</a>(tti_rx, ack_resource.<a class="code" href="structsrsran__harq__ack__resource__t.html#a9f6d58e37cc5b0990150537d65a19d45">k1</a>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// Prepare ACK information</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="structsrsran__harq__ack__m__t.html">srsran_harq_ack_m_t</a> ack_m = {};</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    ack_m.<a class="code" href="structsrsran__harq__ack__m__t.html#ae7855cf652200139a7008bd2bc3acf8a">resource</a>            = ack_resource;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    ack_m.<a class="code" href="structsrsran__harq__ack__m__t.html#accc3ee5f5db7b647df8da35f8bf9d416">value</a>[0]            = crc_ok ? 1 : 0;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    ack_m.<a class="code" href="structsrsran__harq__ack__m__t.html#af0e06a272080feea6c6049946bdb1808">present</a>             = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// Scope mutex to protect read/write the list</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a83c09ac445dd136d6049eb4d6989685a">pending_ack_mutex</a>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// Select UL transmission time resource</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="structsrsran__pdsch__ack__nr__t.html">srsran_pdsch_ack_nr_t</a>&amp; ack = <a class="code" href="classsrsue_1_1nr_1_1state.html#a2ec243a32a91ddb9335831bd23d18f23">pending_ack</a>[tti_tx];</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    ack.<a class="code" href="structsrsran__pdsch__ack__nr__t.html#a645a709422915993c92965ece2488db9">nof_cc</a>                 = 1;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// Insert PDSCH transmission information</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="harq__ack_8h.html#a7f25ddaef651b82eb8b79f5652e24c9d">srsran_harq_ack_insert_m</a>(&amp;ack, &amp;ack_m) &lt; <a class="code" href="config_8h.html#adfad7b94311dafac5a16dec17b4ab20d">SRSRAN_SUCCESS</a>) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <a class="code" href="debug_8h.html#aff62ee963c9ecc544894676b842e9491">ERROR</a>(<span class="stringliteral">&quot;Error inserting ACK m value for Tx slot %d&quot;</span>, tti_tx);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a1640036e94423380563d2a8e5dfc7ca7">  274</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a1640036e94423380563d2a8e5dfc7ca7">get_pending_ack</a>(<span class="keyword">const</span> uint32_t&amp; tti_tx, <a class="code" href="structsrsran__pdsch__ack__nr__t.html">srsran_pdsch_ack_nr_t</a>&amp; pdsch_ack)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// Scope mutex to protect read/write the list</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a83c09ac445dd136d6049eb4d6989685a">pending_ack_mutex</a>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">// Select UL transmission time resource</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="structsrsran__pdsch__ack__nr__t.html">srsran_pdsch_ack_nr_t</a>&amp; ack = <a class="code" href="classsrsue_1_1nr_1_1state.html#a2ec243a32a91ddb9335831bd23d18f23">pending_ack</a>[tti_tx];</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// No pending grant was set</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">if</span> (ack.<a class="code" href="structsrsran__pdsch__ack__nr__t.html#a645a709422915993c92965ece2488db9">nof_cc</a> == 0) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// Copy data</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    pdsch_ack = ack;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// Reset list entry</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    ack = {};</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a0b36e67d61d540b0baba0d149b7430ea">  296</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a0b36e67d61d540b0baba0d149b7430ea">reset</a>()</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#af6a55cbcc1f56016068159d573543bcf">clear_pending_grants</a>();</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#acd033ae1fb912147bd987cf940cdc27a">reset_metrics</a>();</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#a814c1340cefe851e2c57c2cc2964b3a5">reset_measurements</a>();</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a2e51b7321e5671a1efc351529bddd83d">  303</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a2e51b7321e5671a1efc351529bddd83d">has_valid_sr_resource</a>(<span class="keyword">const</span> <a class="code" href="structsrsran_1_1phy__cfg__nr__t.html">srsran::phy_cfg_nr_t</a>&amp; cfg, uint32_t sr_id)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="structSRSRAN__API.html">srsran_pucch_nr_sr_resource_t</a>&amp; r : cfg.<a class="code" href="structsrsran_1_1phy__cfg__nr__t.html#afe4f5d0dac97746a3b33e917d0bb7ed9">pucch</a>.<a class="code" href="structSRSRAN__API.html#a37bc734337087668b5c3be5cd7b9d806">sr_resources</a>) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">if</span> (r.<a class="code" href="structSRSRAN__API.html#ae78da29ebcd5453cd1f31c3369304b2a">configured</a> &amp;&amp; r.<a class="code" href="structSRSRAN__API.html#ada58b70f263a36969934f7a347d1ff61">sr_id</a> == sr_id) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#af6a55cbcc1f56016068159d573543bcf">  313</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#af6a55cbcc1f56016068159d573543bcf">clear_pending_grants</a>()</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// Clear all PDSCH assignments and PUSCH grants</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// Scope mutex to protect read/write each list</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a409be00b694fce56bc1847e76826db15">pending_ul_grant_mutex</a>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <a class="code" href="classsrsue_1_1nr_1_1state.html#a2234f49a90ddaf128c2cbca8c17ab588">pending_ul_grant</a> = {};</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#abb7424b02a0e5298fe56493d93e5af79">pending_dl_grant_mutex</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <a class="code" href="classsrsue_1_1nr_1_1state.html#a3e75521102a6ea3bfdb796a401f26ebd">pending_dl_grant</a> = {};</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a83c09ac445dd136d6049eb4d6989685a">pending_ack_mutex</a>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <a class="code" href="classsrsue_1_1nr_1_1state.html#a2ec243a32a91ddb9335831bd23d18f23">pending_ack</a> = {};</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a4b18e6c6cafe5356dfde37eae28fc2d4">  331</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a4b18e6c6cafe5356dfde37eae28fc2d4">get_pending_sr</a>(<span class="keyword">const</span> <a class="code" href="structsrsran_1_1phy__cfg__nr__t.html">srsran::phy_cfg_nr_t</a>&amp; cfg, <span class="keyword">const</span> uint32_t&amp; <a class="code" href="npdcch__file__test_8c.html#a889c172169d7aa27ba5942efe7dbee83">tti</a>, <a class="code" href="structSRSRAN__API.html">srsran_uci_data_nr_t</a>&amp; uci_data)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// Calculate all SR opportunities in the given TTI</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    uint32_t sr_resource_id[<a class="code" href="pucch__cfg__nr_8h.html#a231c1d77814b53c9d8b9b8f535f387cb">SRSRAN_PUCCH_MAX_NOF_SR_RESOURCES</a>] = {};</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">int</span>      n = <a class="code" href="ue__ul__nr_8h.html#a9246bad921a9d3e3c21e19c2de01d098">srsran_ue_ul_nr_sr_send_slot</a>(cfg.<a class="code" href="structsrsran_1_1phy__cfg__nr__t.html#afe4f5d0dac97746a3b33e917d0bb7ed9">pucch</a>.<a class="code" href="structSRSRAN__API.html#a37bc734337087668b5c3be5cd7b9d806">sr_resources</a>, <a class="code" href="npdcch__file__test_8c.html#a889c172169d7aa27ba5942efe7dbee83">tti</a>, sr_resource_id);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">if</span> (n &lt; <a class="code" href="config_8h.html#adfad7b94311dafac5a16dec17b4ab20d">SRSRAN_SUCCESS</a>) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <a class="code" href="debug_8h.html#aff62ee963c9ecc544894676b842e9491">ERROR</a>(<span class="stringliteral">&quot;Calculating SR opportunities&quot;</span>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// Initialise counters</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    uint32_t sr_count_all      = (uint32_t)n; <span class="comment">// Number of opportunities in this TTI</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    uint32_t sr_count_positive = 0;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// Iterate all opportunities and check if there is a pending SR</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; sr_count_all; i++) {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="comment">// Extract SR identifier</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      uint32_t sr_id = cfg.<a class="code" href="structsrsran_1_1phy__cfg__nr__t.html#afe4f5d0dac97746a3b33e917d0bb7ed9">pucch</a>.<a class="code" href="structSRSRAN__API.html#a37bc734337087668b5c3be5cd7b9d806">sr_resources</a>[sr_resource_id[i]].<a class="code" href="structSRSRAN__API.html#ada58b70f263a36969934f7a347d1ff61">sr_id</a>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="comment">// Check if the SR resource ID is pending</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classsrsue_1_1nr_1_1state.html#a5ec642b321a3aa3f2865d4be6455260b">args</a>.<a class="code" href="structsrsue_1_1phy__args__nr__t.html#a2fa097ea0b3e836e97b5b38507998180">fixed_sr</a>.count(sr_id) &gt; 0 ||</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;          <a class="code" href="classsrsue_1_1nr_1_1state.html#a8832b1e822846d912c9d001ede7172c5">stack</a>-&gt;<a class="code" href="classsrsue_1_1mac__interface__phy__nr.html#a5a7a89995b716397052b6a3b36a736b3">sr_opportunity</a>(<a class="code" href="npdcch__file__test_8c.html#a889c172169d7aa27ba5942efe7dbee83">tti</a>, sr_id, <span class="keyword">false</span>, <a class="code" href="classsrsue_1_1nr_1_1state.html#a2234f49a90ddaf128c2cbca8c17ab588">pending_ul_grant</a>[<a class="code" href="common_2common_8h.html#a5b6441bc63ac58ce10deed94870fe989">TTI_TX</a>(<a class="code" href="npdcch__file__test_8c.html#a889c172169d7aa27ba5942efe7dbee83">tti</a>)].enable)) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment">// Count it as present</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        sr_count_positive++;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">// Configure SR fields in UCI data</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    uci_data.<a class="code" href="structSRSRAN__API.html#a0b5da7f4f30a0a3c1d802303b0a0e4f6">cfg</a>.<a class="code" href="structSRSRAN__API.html#a59456e1c38b3419f1af9ab7b7e966921">pucch</a>.sr_resource_id = sr_resource_id[0];</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    uci_data.<a class="code" href="structSRSRAN__API.html#a0b5da7f4f30a0a3c1d802303b0a0e4f6">cfg</a>.<a class="code" href="structSRSRAN__API.html#a5166327513cb1397f4ef1db5562ab016">o_sr</a>                 = <a class="code" href="ra__ul__nr_8h.html#a1729e74ca5ab3c4448643b28e62f14ca">srsran_ra_ul_nr_nof_sr_bits</a>(sr_count_all);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    uci_data.<a class="code" href="structSRSRAN__API.html#a0b5da7f4f30a0a3c1d802303b0a0e4f6">cfg</a>.<a class="code" href="structSRSRAN__API.html#a376f588172a6a7174619a47d3054696e">sr_positive_present</a>  = sr_count_positive &gt; 0;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    uci_data.<a class="code" href="structSRSRAN__API.html#a682bcef153ed00a3c13db2f61a5102ee">value</a>.<a class="code" href="structSRSRAN__API.html#a37f91f6abcce1cd60aea7c00c7d4b677">sr</a>                 = sr_count_positive;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#ad82f70344d4d65ad55e49a20af9e6e86">  366</a></span>&#160;  <a class="code" href="classsrsue_1_1nr_1_1state.html#ad82f70344d4d65ad55e49a20af9e6e86">get_periodic_csi</a>(<span class="keyword">const</span> <a class="code" href="structsrsran_1_1phy__cfg__nr__t.html">srsran::phy_cfg_nr_t</a>&amp; cfg, <span class="keyword">const</span> <a class="code" href="structSRSRAN__API.html">srsran_slot_cfg_t</a>&amp; slot_cfg, <a class="code" href="structSRSRAN__API.html">srsran_uci_data_nr_t</a>&amp; uci_data)</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">// Generate report configurations</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordtype">int</span> n = <a class="code" href="csi_8h.html#aa6656effec046c2bed6c3ee2dbd2151c">srsran_csi_reports_generate</a>(&amp;cfg.<a class="code" href="structsrsran_1_1phy__cfg__nr__t.html#afd4ade189fe7efd5a295b9ddd0667d0e">csi</a>, &amp;slot_cfg, uci_data.<a class="code" href="structSRSRAN__API.html#a0b5da7f4f30a0a3c1d802303b0a0e4f6">cfg</a>.<a class="code" href="structSRSRAN__API.html#a2dd0c7cedacf51cb5b8080789c358c6e">csi</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">if</span> (n &gt; <a class="code" href="config_8h.html#adfad7b94311dafac5a16dec17b4ab20d">SRSRAN_SUCCESS</a>) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      uci_data.<a class="code" href="structSRSRAN__API.html#a0b5da7f4f30a0a3c1d802303b0a0e4f6">cfg</a>.<a class="code" href="structSRSRAN__API.html#a43d8a173301138c9fd1ffe9f044d9f2b">nof_csi</a> = n;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// Quantify reports from measurements</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    n = <a class="code" href="csi_8h.html#ad4286d64aae0782552a04b9a5e866403">srsran_csi_reports_quantify</a>(uci_data.<a class="code" href="structSRSRAN__API.html#a0b5da7f4f30a0a3c1d802303b0a0e4f6">cfg</a>.<a class="code" href="structSRSRAN__API.html#a2dd0c7cedacf51cb5b8080789c358c6e">csi</a>, <a class="code" href="classsrsue_1_1nr_1_1state.html#aa8849a969d7ce49d7b3e5f43d57d3ce1">csi_measurements</a>.data(), uci_data.<a class="code" href="structSRSRAN__API.html#a682bcef153ed00a3c13db2f61a5102ee">value</a>.<a class="code" href="structSRSRAN__API.html#a2dd0c7cedacf51cb5b8080789c358c6e">csi</a>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">if</span> (n &gt; <a class="code" href="config_8h.html#adfad7b94311dafac5a16dec17b4ab20d">SRSRAN_SUCCESS</a>) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      uci_data.<a class="code" href="structSRSRAN__API.html#a0b5da7f4f30a0a3c1d802303b0a0e4f6">cfg</a>.<a class="code" href="structSRSRAN__API.html#a43d8a173301138c9fd1ffe9f044d9f2b">nof_csi</a> = n;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// Set fix wideband CQI if it is not zero nor greater than 15</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classsrsue_1_1nr_1_1state.html#a5ec642b321a3aa3f2865d4be6455260b">args</a>.<a class="code" href="structsrsue_1_1phy__args__nr__t.html#ad3551078cdca656ec7b0942e7de5b659">fix_wideband_cqi</a> != 0 &amp;&amp; <a class="code" href="classsrsue_1_1nr_1_1state.html#a5ec642b321a3aa3f2865d4be6455260b">args</a>.<a class="code" href="structsrsue_1_1phy__args__nr__t.html#ad3551078cdca656ec7b0942e7de5b659">fix_wideband_cqi</a> &lt; 15) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; uci_data.<a class="code" href="structSRSRAN__API.html#a0b5da7f4f30a0a3c1d802303b0a0e4f6">cfg</a>.<a class="code" href="structSRSRAN__API.html#a43d8a173301138c9fd1ffe9f044d9f2b">nof_csi</a>; i++) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">if</span> (uci_data.<a class="code" href="structSRSRAN__API.html#a0b5da7f4f30a0a3c1d802303b0a0e4f6">cfg</a>.<a class="code" href="structSRSRAN__API.html#a2dd0c7cedacf51cb5b8080789c358c6e">csi</a>[i].cfg.quantity == <a class="code" href="csi__cfg_8h.html#a30dbfab261dd8f818d3b353015c3c30ea5f2e9d7c40f1a67c9b7615ce276dc240">SRSRAN_CSI_REPORT_QUANTITY_CRI_RI_PMI_CQI</a> &amp;&amp;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            uci_data.<a class="code" href="structSRSRAN__API.html#a0b5da7f4f30a0a3c1d802303b0a0e4f6">cfg</a>.<a class="code" href="structSRSRAN__API.html#a2dd0c7cedacf51cb5b8080789c358c6e">csi</a>[i].cfg.freq_cfg == <a class="code" href="csi__cfg_8h.html#a30dbfab261dd8f818d3b353015c3c30ea4a3861dabf7919c553a2e01a0889f5df">SRSRAN_CSI_REPORT_FREQ_WIDEBAND</a>) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          uci_data.<a class="code" href="structSRSRAN__API.html#a682bcef153ed00a3c13db2f61a5102ee">value</a>.<a class="code" href="structSRSRAN__API.html#a2dd0c7cedacf51cb5b8080789c358c6e">csi</a>[i].wideband_cri_ri_pmi_cqi.cqi = <a class="code" href="classsrsue_1_1nr_1_1state.html#a5ec642b321a3aa3f2865d4be6455260b">args</a>.<a class="code" href="structsrsue_1_1phy__args__nr__t.html#ad3551078cdca656ec7b0942e7de5b659">fix_wideband_cqi</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    uci_data.<a class="code" href="structSRSRAN__API.html#a0b5da7f4f30a0a3c1d802303b0a0e4f6">cfg</a>.<a class="code" href="structSRSRAN__API.html#a59456e1c38b3419f1af9ab7b7e966921">pucch</a>.<a class="code" href="structSRSRAN__API.html#a453fb28483754a8cb13acbe97f606731">rnti</a> = <a class="code" href="classsrsue_1_1nr_1_1state.html#a8832b1e822846d912c9d001ede7172c5">stack</a>-&gt;<a class="code" href="classsrsue_1_1mac__interface__phy__nr.html#aa99b0eb568e20ca593b0d628a3ddf64c">get_ul_sched_rnti_nr</a>(slot_cfg.<a class="code" href="structSRSRAN__API.html#a4d6cbb09d61d0ab7dbd8dc3a5160efd2">idx</a>).<a class="code" href="structsrsue_1_1mac__interface__phy__nr_1_1sched__rnti__t.html#a1d67dea3a1edf0e3751a34262d3681ab">id</a>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#abcb27ff27d3b6d94e980e95006faea6b">  397</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#abcb27ff27d3b6d94e980e95006faea6b">set_info_metrics</a>(<span class="keyword">const</span> <a class="code" href="structsrsue_1_1info__metrics__t.html">info_metrics_t</a>&amp; <a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a138942764c8e8ba32a7ec7e3ebd6667e">metrics_mutex</a>);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#a65c22efd981cab343ae01b09ab81147d">info_metrics</a> = <a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a855200674c8d97304fc172c3248c4713">  407</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a855200674c8d97304fc172c3248c4713">set_sync_metrics</a>(<span class="keyword">const</span> <a class="code" href="structsrsue_1_1sync__metrics__t.html">sync_metrics_t</a>&amp; <a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a138942764c8e8ba32a7ec7e3ebd6667e">metrics_mutex</a>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#af367acfa7c9f61585e7511aa5246a3f6">sync_metrics</a>.<a class="code" href="structsrsue_1_1sync__metrics__t.html#ad7e474816ddb3932bc8037ec07944656">set</a>(<a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a2abcad4f612010b1add092b0b20a5dc6">  417</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a2abcad4f612010b1add092b0b20a5dc6">set_channel_metrics</a>(<span class="keyword">const</span> <a class="code" href="structsrsue_1_1ch__metrics__t.html">ch_metrics_t</a>&amp; <a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a138942764c8e8ba32a7ec7e3ebd6667e">metrics_mutex</a>);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#a11dc9f4b7025073bb21bffbd55448428">ch_metrics</a>.<a class="code" href="structsrsue_1_1ch__metrics__t.html#af2f74e8ad4213adbcee356408d2b4bbf">set</a>(<a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a4623e224fada2fa93b1044f5d5d5331f">  427</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a4623e224fada2fa93b1044f5d5d5331f">set_dl_metrics</a>(<span class="keyword">const</span> <a class="code" href="structsrsue_1_1dl__metrics__t.html">dl_metrics_t</a>&amp; <a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a138942764c8e8ba32a7ec7e3ebd6667e">metrics_mutex</a>);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#a995b7643d22b218f30b86f5e6d5f559b">dl_metrics</a>.<a class="code" href="structsrsue_1_1dl__metrics__t.html#a894e52b6dc2f10648b89f0a95539a6fb">set</a>(<a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a01452349a32cf55b77c2e82c8cd16ed3">  437</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a01452349a32cf55b77c2e82c8cd16ed3">set_ul_metrics</a>(<span class="keyword">const</span> <a class="code" href="structsrsue_1_1ul__metrics__t.html">ul_metrics_t</a>&amp; <a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a138942764c8e8ba32a7ec7e3ebd6667e">metrics_mutex</a>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#ae9d8a85c42551eb2446a0e8a010712f3">ul_metrics</a>.<a class="code" href="structsrsue_1_1ul__metrics__t.html#a74d0f13f36c3c2e037c40f7ddf59696c">set</a>(<a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#acd033ae1fb912147bd987cf940cdc27a">  446</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#acd033ae1fb912147bd987cf940cdc27a">reset_metrics</a>()</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a138942764c8e8ba32a7ec7e3ebd6667e">metrics_mutex</a>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#aeb03433bdd0494f672bebded74a38c03">reset_metrics_</a>();</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a3cf7b4d156c2893c54f15e6561c2076e">  456</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a3cf7b4d156c2893c54f15e6561c2076e">get_metrics</a>(<a class="code" href="structsrsue_1_1phy__metrics__t.html">phy_metrics_t</a>&amp; <a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a138942764c8e8ba32a7ec7e3ebd6667e">metrics_mutex</a>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    uint32_t cc = <a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>.nof_active_cc;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>.info[cc]  = <a class="code" href="classsrsue_1_1nr_1_1state.html#a65c22efd981cab343ae01b09ab81147d">info_metrics</a>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>.sync[cc]  = <a class="code" href="classsrsue_1_1nr_1_1state.html#af367acfa7c9f61585e7511aa5246a3f6">sync_metrics</a>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>.ch[cc]    = <a class="code" href="classsrsue_1_1nr_1_1state.html#a11dc9f4b7025073bb21bffbd55448428">ch_metrics</a>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>.dl[cc]    = <a class="code" href="classsrsue_1_1nr_1_1state.html#a995b7643d22b218f30b86f5e6d5f559b">dl_metrics</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>.ul[cc]    = <a class="code" href="classsrsue_1_1nr_1_1state.html#ae9d8a85c42551eb2446a0e8a010712f3">ul_metrics</a>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a>.nof_active_cc++;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// Reset all metrics</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#aeb03433bdd0494f672bebded74a38c03">reset_metrics_</a>();</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a814c1340cefe851e2c57c2cc2964b3a5">  475</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a814c1340cefe851e2c57c2cc2964b3a5">reset_measurements</a>()</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a418e6cae3a9d919f0b7321f9375a0183">csi_measurements_mutex</a>);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#aa8849a969d7ce49d7b3e5f43d57d3ce1">csi_measurements</a> = {};</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a14c53d23946f7f27779af8f40a043327">  487</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a14c53d23946f7f27779af8f40a043327">new_nzp_csi_rs_channel_measurement</a>(<span class="keyword">const</span> <a class="code" href="structsrsran_1_1phy__cfg__nr__t.html">srsran::phy_cfg_nr_t</a>&amp;              cfg,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                          <span class="keyword">const</span> <a class="code" href="structSRSRAN__API.html">srsran_csi_channel_measurements_t</a>&amp; new_measure,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                          uint32_t                                 resource_set_id)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#a418e6cae3a9d919f0b7321f9375a0183">csi_measurements_mutex</a>);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="csi_8h.html#a195c8274a3ed7b354e9f9aeb8fffe22e">srsran_csi_new_nzp_csi_rs_measurement</a>(</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            cfg.<a class="code" href="structsrsran_1_1phy__cfg__nr__t.html#afd4ade189fe7efd5a295b9ddd0667d0e">csi</a>.<a class="code" href="structSRSRAN__API.html#aa22ed31f47357ebec4a6384f23713350">csi_resources</a>, <a class="code" href="classsrsue_1_1nr_1_1state.html#aa8849a969d7ce49d7b3e5f43d57d3ce1">csi_measurements</a>.data(), &amp;new_measure, resource_set_id) &lt; <a class="code" href="config_8h.html#adfad7b94311dafac5a16dec17b4ab20d">SRSRAN_SUCCESS</a>) {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <a class="code" href="debug_8h.html#aff62ee963c9ecc544894676b842e9491">ERROR</a>(<span class="stringliteral">&quot;Error processing new NZP-CSI-RS&quot;</span>);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a9051fbab45675e961b36fc722745db5a">  509</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a9051fbab45675e961b36fc722745db5a">new_csi_trs_measurement</a>(<span class="keyword">const</span> <a class="code" href="structSRSRAN__API.html">srsran_csi_trs_measurements_t</a>&amp; new_meas,</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                               <span class="keyword">const</span> <a class="code" href="structsrsran_1_1phy__cfg__nr__t.html">srsran::phy_cfg_nr_t</a>&amp;          cfg,</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                               uint32_t                             resource_set_id = 0,</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                               uint32_t                             K_csi_rs        = 0)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">// Compute channel metrics and push it</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <a class="code" href="structsrsue_1_1ch__metrics__t.html">ch_metrics_t</a> new_ch_metrics = {};</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    new_ch_metrics.<a class="code" href="structsrsue_1_1ch__metrics__t.html#a62789b30987b7d7c5d0a8890bcddca8a">sinr</a>         = new_meas.<a class="code" href="structSRSRAN__API.html#a3a167dff1d6e256b4b816236a64866e5">snr_dB</a>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    new_ch_metrics.<a class="code" href="structsrsue_1_1ch__metrics__t.html#a808594e95c36db195dc9f75ebbe7e674">rsrp</a>         = new_meas.<a class="code" href="structSRSRAN__API.html#a7d7c9b371ac92b35a7160eb8afb4bfc7">rsrp_dB</a>;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    new_ch_metrics.<a class="code" href="structsrsue_1_1ch__metrics__t.html#aa3f9c0841c3d6a8c923e970275ee6452">rsrq</a>         = 0.0f; <span class="comment">// Not supported</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    new_ch_metrics.<a class="code" href="structsrsue_1_1ch__metrics__t.html#a069aaeebd1b321d5905cb7ec9b08fa2f">rssi</a>         = 0.0f; <span class="comment">// Not supported</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    new_ch_metrics.<a class="code" href="structsrsue_1_1ch__metrics__t.html#aede4ba0c05a28e8347153209015e70d3">sync_err</a>     = new_meas.<a class="code" href="structSRSRAN__API.html#a2671a9e27009934186b111498e666e7a">delay_us</a>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#a2abcad4f612010b1add092b0b20a5dc6">set_channel_metrics</a>(new_ch_metrics);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">// Compute synch metrics and report it to the PHY state</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="structsrsue_1_1sync__metrics__t.html">sync_metrics_t</a> new_sync_metrics = {};</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    new_sync_metrics.<a class="code" href="structsrsue_1_1sync__metrics__t.html#a9de8466d903846bcb8d1aa4ad2a9d82a">cfo</a>            = new_meas.<a class="code" href="structSRSRAN__API.html#a18ea71cae80d86c130c45a3735c77fdb">cfo_hz</a> + <a class="code" href="classsrsue_1_1nr_1_1state.html#a27163182ff61aa6a8fad2297f8912916">ul_ext_cfo_hz</a>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#a855200674c8d97304fc172c3248c4713">set_sync_metrics</a>(new_sync_metrics);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// Convert to CSI channel measurement and report new NZP-CSI-RS measurement to the PHY state</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="structSRSRAN__API.html">srsran_csi_channel_measurements_t</a> measurements = {};</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    measurements.<a class="code" href="structSRSRAN__API.html#ad66a75bd892aea256523de710ed872d6">cri</a>                               = 0;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    measurements.<a class="code" href="structSRSRAN__API.html#a848d8edae3778a25b675f2cc223ba3d2">wideband_rsrp_dBm</a>                 = new_meas.<a class="code" href="structSRSRAN__API.html#a7d7c9b371ac92b35a7160eb8afb4bfc7">rsrp_dB</a>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    measurements.<a class="code" href="structSRSRAN__API.html#aa9a40b267774e99d7c3f76895dcff4af">wideband_epre_dBm</a>                 = new_meas.<a class="code" href="structSRSRAN__API.html#a906ab09fe03202c5d622d440279114c9">epre_dB</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    measurements.<a class="code" href="structSRSRAN__API.html#ac5013770670001287f48aae6cde102b2">wideband_snr_db</a>                   = new_meas.<a class="code" href="structSRSRAN__API.html#a3a167dff1d6e256b4b816236a64866e5">snr_dB</a>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    measurements.<a class="code" href="structSRSRAN__API.html#a4fc206a59046959755b8c231c8390ef8">nof_ports</a>                         = 1; <span class="comment">// Other values are not supported</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    measurements.<a class="code" href="structSRSRAN__API.html#aadcee8fd26f02ba7684267ad1705cd68">K_csi_rs</a>                          = K_csi_rs;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#a14c53d23946f7f27779af8f40a043327">new_nzp_csi_rs_channel_measurement</a>(cfg, measurements, resource_set_id);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">// Update tracking information</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#afcd752ab157b166ab7df7d24fb88e6ae">trs_measurements_mutex</a>.lock();</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#ac7dd5bcc67a6e59ad73f8b75071fcf19">trs_measurements</a>.<a class="code" href="structSRSRAN__API.html#a7d7c9b371ac92b35a7160eb8afb4bfc7">rsrp_dB</a> = <a class="code" href="vector_8h.html#a182c1cf7e5f1874d4d5ece461860f815">SRSRAN_VEC_SAFE_EMA</a>(new_meas.<a class="code" href="structSRSRAN__API.html#a7d7c9b371ac92b35a7160eb8afb4bfc7">rsrp_dB</a>, <a class="code" href="classsrsue_1_1nr_1_1state.html#ac7dd5bcc67a6e59ad73f8b75071fcf19">trs_measurements</a>.<a class="code" href="structSRSRAN__API.html#a7d7c9b371ac92b35a7160eb8afb4bfc7">rsrp_dB</a>, <a class="code" href="classsrsue_1_1nr_1_1state.html#a5ec642b321a3aa3f2865d4be6455260b">args</a>.<a class="code" href="structsrsue_1_1phy__args__nr__t.html#a3b1d4d318ee039901f99cfd637d80ab0">trs_epre_ema_alpha</a>);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#ac7dd5bcc67a6e59ad73f8b75071fcf19">trs_measurements</a>.<a class="code" href="structSRSRAN__API.html#a906ab09fe03202c5d622d440279114c9">epre_dB</a> = <a class="code" href="vector_8h.html#a182c1cf7e5f1874d4d5ece461860f815">SRSRAN_VEC_SAFE_EMA</a>(new_meas.<a class="code" href="structSRSRAN__API.html#a906ab09fe03202c5d622d440279114c9">epre_dB</a>, <a class="code" href="classsrsue_1_1nr_1_1state.html#ac7dd5bcc67a6e59ad73f8b75071fcf19">trs_measurements</a>.<a class="code" href="structSRSRAN__API.html#a906ab09fe03202c5d622d440279114c9">epre_dB</a>, <a class="code" href="classsrsue_1_1nr_1_1state.html#a5ec642b321a3aa3f2865d4be6455260b">args</a>.<a class="code" href="structsrsue_1_1phy__args__nr__t.html#a7e82c8d92cbc0f443a621d0189f5d4d5">trs_rsrp_ema_alpha</a>);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#ac7dd5bcc67a6e59ad73f8b75071fcf19">trs_measurements</a>.<a class="code" href="structSRSRAN__API.html#a3a167dff1d6e256b4b816236a64866e5">snr_dB</a>  = <a class="code" href="vector_8h.html#a182c1cf7e5f1874d4d5ece461860f815">SRSRAN_VEC_SAFE_EMA</a>(new_meas.<a class="code" href="structSRSRAN__API.html#a3a167dff1d6e256b4b816236a64866e5">snr_dB</a>, <a class="code" href="classsrsue_1_1nr_1_1state.html#ac7dd5bcc67a6e59ad73f8b75071fcf19">trs_measurements</a>.<a class="code" href="structSRSRAN__API.html#a3a167dff1d6e256b4b816236a64866e5">snr_dB</a>, <a class="code" href="classsrsue_1_1nr_1_1state.html#a5ec642b321a3aa3f2865d4be6455260b">args</a>.<a class="code" href="structsrsue_1_1phy__args__nr__t.html#a8d3d3e154389a5003ddcea19e779a27e">trs_sinr_ema_alpha</a>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">// Consider CFO measurement invalid if the SNR is negative. In this case, set CFO to 0.</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">if</span> (new_meas.<a class="code" href="structSRSRAN__API.html#a3a167dff1d6e256b4b816236a64866e5">snr_dB</a> &gt; 0.0f) {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <a class="code" href="classsrsue_1_1nr_1_1state.html#ac7dd5bcc67a6e59ad73f8b75071fcf19">trs_measurements</a>.<a class="code" href="structSRSRAN__API.html#a18ea71cae80d86c130c45a3735c77fdb">cfo_hz</a> = <a class="code" href="vector_8h.html#a182c1cf7e5f1874d4d5ece461860f815">SRSRAN_VEC_SAFE_EMA</a>(new_meas.<a class="code" href="structSRSRAN__API.html#a18ea71cae80d86c130c45a3735c77fdb">cfo_hz</a>, <a class="code" href="classsrsue_1_1nr_1_1state.html#ac7dd5bcc67a6e59ad73f8b75071fcf19">trs_measurements</a>.<a class="code" href="structSRSRAN__API.html#a18ea71cae80d86c130c45a3735c77fdb">cfo_hz</a>, <a class="code" href="classsrsue_1_1nr_1_1state.html#a5ec642b321a3aa3f2865d4be6455260b">args</a>.<a class="code" href="structsrsue_1_1phy__args__nr__t.html#aced50a77c8422eccdaeaedc707261ece">trs_cfo_ema_alpha</a>);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#ac7dd5bcc67a6e59ad73f8b75071fcf19">trs_measurements</a>.<a class="code" href="structSRSRAN__API.html#ad1805c987ba164b91075183e5dada7db">nof_re</a>++;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="classsrsue_1_1nr_1_1state.html#afcd752ab157b166ab7df7d24fb88e6ae">trs_measurements_mutex</a>.unlock();</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a815ce59bdad2df67934e5b2e76a6f62a">  551</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a815ce59bdad2df67934e5b2e76a6f62a">get_dl_cfo</a>()</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#afcd752ab157b166ab7df7d24fb88e6ae">trs_measurements_mutex</a>);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#ac7dd5bcc67a6e59ad73f8b75071fcf19">trs_measurements</a>.<a class="code" href="structSRSRAN__API.html#a18ea71cae80d86c130c45a3735c77fdb">cfo_hz</a>;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a3c3bfb783355589968de3f45b4e647ff">  557</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a3c3bfb783355589968de3f45b4e647ff">get_ul_cfo</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    std::lock_guard&lt;std::mutex&gt; lock(<a class="code" href="classsrsue_1_1nr_1_1state.html#afcd752ab157b166ab7df7d24fb88e6ae">trs_measurements_mutex</a>);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#ac7dd5bcc67a6e59ad73f8b75071fcf19">trs_measurements</a>.<a class="code" href="structSRSRAN__API.html#a18ea71cae80d86c130c45a3735c77fdb">cfo_hz</a> + <a class="code" href="classsrsue_1_1nr_1_1state.html#a27163182ff61aa6a8fad2297f8912916">ul_ext_cfo_hz</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="classsrsue_1_1nr_1_1state.html#a05bf6d40d528e36f019020070aec1c34">  563</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsue_1_1nr_1_1state.html#a05bf6d40d528e36f019020070aec1c34">set_ul_ext_cfo</a>(<span class="keywordtype">float</span> ext_cfo_hz) { <a class="code" href="classsrsue_1_1nr_1_1state.html#a27163182ff61aa6a8fad2297f8912916">ul_ext_cfo_hz</a> = ext_cfo_hz; }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;};</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;} <span class="comment">// namespace nr</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;} <span class="comment">// namespace srsue</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="preprocessor">#endif // SRSRAN_STATE_H</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="astructsrsue_1_1phy__metrics__t_html"><div class="ttname"><a href="structsrsue_1_1phy__metrics__t.html">srsue::phy_metrics_t</a></div><div class="ttdef"><b>Definition:</b> phy_metrics.h:173</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a4d6cbb09d61d0ab7dbd8dc3a5160efd2"><div class="ttname"><a href="structSRSRAN__API.html#a4d6cbb09d61d0ab7dbd8dc3a5160efd2">SRSRAN_API::idx</a></div><div class="ttdeci">uint32_t idx</div><div class="ttdoc">Slot index in the radio frame.</div><div class="ttdef"><b>Definition:</b> phy_common_nr.h:409</div></div>
<div class="ttc" id="acsi__cfg_8h_html_a30dbfab261dd8f818d3b353015c3c30ea4a3861dabf7919c553a2e01a0889f5df"><div class="ttname"><a href="csi__cfg_8h.html#a30dbfab261dd8f818d3b353015c3c30ea4a3861dabf7919c553a2e01a0889f5df">SRSRAN_CSI_REPORT_FREQ_WIDEBAND</a></div><div class="ttdeci">@ SRSRAN_CSI_REPORT_FREQ_WIDEBAND</div><div class="ttdef"><b>Definition:</b> csi_cfg.h:89</div></div>
<div class="ttc" id="astructSRSRAN__API_html_aa22ed31f47357ebec4a6384f23713350"><div class="ttname"><a href="structSRSRAN__API.html#aa22ed31f47357ebec4a6384f23713350">SRSRAN_API::csi_resources</a></div><div class="ttdeci">srsran_csi_hl_resource_cfg_t csi_resources[SRSRAN_CSI_MAX_NOF_RESOURCES]</div><div class="ttdef"><b>Definition:</b> csi_cfg.h:159</div></div>
<div class="ttc" id="astructsrsue_1_1dl__metrics__t_html"><div class="ttname"><a href="structsrsue_1_1dl__metrics__t.html">srsue::dl_metrics_t</a></div><div class="ttdef"><b>Definition:</b> phy_metrics.h:120</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_afcd752ab157b166ab7df7d24fb88e6ae"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#afcd752ab157b166ab7df7d24fb88e6ae">srsue::nr::state::trs_measurements_mutex</a></div><div class="ttdeci">std::mutex trs_measurements_mutex</div><div class="ttdoc">TRS measurements.</div><div class="ttdef"><b>Definition:</b> state.h:73</div></div>
<div class="ttc" id="astructsrsue_1_1mac__interface__phy__nr_1_1sched__rnti__t_html_a1d67dea3a1edf0e3751a34262d3681ab"><div class="ttname"><a href="structsrsue_1_1mac__interface__phy__nr_1_1sched__rnti__t.html#a1d67dea3a1edf0e3751a34262d3681ab">srsue::mac_interface_phy_nr::sched_rnti_t::id</a></div><div class="ttdeci">uint16_t id</div><div class="ttdef"><b>Definition:</b> ue_nr_interfaces.h:131</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a14c53d23946f7f27779af8f40a043327"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a14c53d23946f7f27779af8f40a043327">srsue::nr::state::new_nzp_csi_rs_channel_measurement</a></div><div class="ttdeci">void new_nzp_csi_rs_channel_measurement(const srsran::phy_cfg_nr_t &amp;cfg, const srsran_csi_channel_measurements_t &amp;new_measure, uint32_t resource_set_id)</div><div class="ttdoc">Processes a new NZP-CSI-RS channel measurement.</div><div class="ttdef"><b>Definition:</b> state.h:487</div></div>
<div class="ttc" id="aue__nr__interfaces_8h_html"><div class="ttname"><a href="ue__nr__interfaces_8h.html">ue_nr_interfaces.h</a></div></div>
<div class="ttc" id="astructsrsue_1_1ch__metrics__t_html_a808594e95c36db195dc9f75ebbe7e674"><div class="ttname"><a href="structsrsue_1_1ch__metrics__t.html#a808594e95c36db195dc9f75ebbe7e674">srsue::ch_metrics_t::rsrp</a></div><div class="ttdeci">float rsrp</div><div class="ttdef"><b>Definition:</b> phy_metrics.h:80</div></div>
<div class="ttc" id="aclasssrsue_1_1mac__interface__phy__nr_html"><div class="ttname"><a href="classsrsue_1_1mac__interface__phy__nr.html">srsue::mac_interface_phy_nr</a></div><div class="ttdef"><b>Definition:</b> ue_nr_interfaces.h:76</div></div>
<div class="ttc" id="astructsrsue_1_1ch__metrics__t_html"><div class="ttname"><a href="structsrsue_1_1ch__metrics__t.html">srsue::ch_metrics_t</a></div><div class="ttdef"><b>Definition:</b> phy_metrics.h:75</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a7d7c9b371ac92b35a7160eb8afb4bfc7"><div class="ttname"><a href="structSRSRAN__API.html#a7d7c9b371ac92b35a7160eb8afb4bfc7">SRSRAN_API::rsrp_dB</a></div><div class="ttdeci">float rsrp_dB</div><div class="ttdoc">Logarithm scale RSRP relative to full-scale.</div><div class="ttdef"><b>Definition:</b> phy_common_nr.h:505</div></div>
<div class="ttc" id="astructsrsue_1_1nr_1_1state_1_1pending__dl__grant__t_html_a6bc98e21ab1f3a613ac02ff99ad3bda9"><div class="ttname"><a href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a6bc98e21ab1f3a613ac02ff99ad3bda9">srsue::nr::state::pending_dl_grant_t::ack_resource</a></div><div class="ttdeci">srsran_harq_ack_resource_t ack_resource</div><div class="ttdef"><b>Definition:</b> state.h:52</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a4fc206a59046959755b8c231c8390ef8"><div class="ttname"><a href="structSRSRAN__API.html#a4fc206a59046959755b8c231c8390ef8">SRSRAN_API::nof_ports</a></div><div class="ttdeci">uint32_t nof_ports</div><div class="ttdoc">Number of antenna ports.</div><div class="ttdef"><b>Definition:</b> csi_rs_cfg.h:94</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a418e6cae3a9d919f0b7321f9375a0183"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a418e6cae3a9d919f0b7321f9375a0183">srsue::nr::state::csi_measurements_mutex</a></div><div class="ttdeci">std::mutex csi_measurements_mutex</div><div class="ttdoc">CSI-RS measurements.</div><div class="ttdef"><b>Definition:</b> state.h:69</div></div>
<div class="ttc" id="astructsrsue_1_1ch__metrics__t_html_aa3f9c0841c3d6a8c923e970275ee6452"><div class="ttname"><a href="structsrsue_1_1ch__metrics__t.html#aa3f9c0841c3d6a8c923e970275ee6452">srsue::ch_metrics_t::rsrq</a></div><div class="ttdeci">float rsrq</div><div class="ttdef"><b>Definition:</b> phy_metrics.h:81</div></div>
<div class="ttc" id="astructsrsran_1_1phy__cfg__nr__t_html"><div class="ttname"><a href="structsrsran_1_1phy__cfg__nr__t.html">srsran::phy_cfg_nr_t</a></div><div class="ttdef"><b>Definition:</b> phy_cfg_nr.h:37</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a2671a9e27009934186b111498e666e7a"><div class="ttname"><a href="structSRSRAN__API.html#a2671a9e27009934186b111498e666e7a">SRSRAN_API::delay_us</a></div><div class="ttdeci">float delay_us</div><div class="ttdoc">Average measured delay in microseconds.</div><div class="ttdef"><b>Definition:</b> phy_common_nr.h:513</div></div>
<div class="ttc" id="astructsrsue_1_1nr_1_1state_1_1pending__ul__grant__t_html_af4dc6397d3c1c1968235a8c006a55bef"><div class="ttname"><a href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#af4dc6397d3c1c1968235a8c006a55bef">srsue::nr::state::pending_ul_grant_t::sch_cfg</a></div><div class="ttdeci">srsran_sch_cfg_nr_t sch_cfg</div><div class="ttdef"><b>Definition:</b> state.h:43</div></div>
<div class="ttc" id="astructsrsue_1_1sync__metrics__t_html_ad7e474816ddb3932bc8037ec07944656"><div class="ttname"><a href="structsrsue_1_1sync__metrics__t.html#ad7e474816ddb3932bc8037ec07944656">srsue::sync_metrics_t::set</a></div><div class="ttdeci">void set(const sync_metrics_t &amp;other)</div><div class="ttdef"><b>Definition:</b> phy_metrics.h:51</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_ae9d8a85c42551eb2446a0e8a010712f3"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#ae9d8a85c42551eb2446a0e8a010712f3">srsue::nr::state::ul_metrics</a></div><div class="ttdeci">ul_metrics_t ul_metrics</div><div class="ttdef"><b>Definition:</b> state.h:65</div></div>
<div class="ttc" id="astructsrsran__harq__ack__m__t_html_af0e06a272080feea6c6049946bdb1808"><div class="ttname"><a href="structsrsran__harq__ack__m__t.html#af0e06a272080feea6c6049946bdb1808">srsran_harq_ack_m_t::present</a></div><div class="ttdeci">bool present</div><div class="ttdef"><b>Definition:</b> harq_ack_cfg.h:54</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a02b5b2bb1beadc3e915f6b51b86970a6"><div class="ttname"><a href="structSRSRAN__API.html#a02b5b2bb1beadc3e915f6b51b86970a6">SRSRAN_API::size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> dft.h:56</div></div>
<div class="ttc" id="acsi_8h_html_ad4286d64aae0782552a04b9a5e866403"><div class="ttname"><a href="csi_8h.html#ad4286d64aae0782552a04b9a5e866403">srsran_csi_reports_quantify</a></div><div class="ttdeci">SRSRAN_API int srsran_csi_reports_quantify(const srsran_csi_report_cfg_t reports[SRSRAN_CSI_SLOT_MAX_NOF_REPORT], const srsran_csi_channel_measurements_t measurements[SRSRAN_CSI_MAX_NOF_RESOURCES], srsran_csi_report_value_t report_value[SRSRAN_CSI_SLOT_MAX_NOF_REPORT])</div><div class="ttdoc">Quantifies a given set of CSI reports from the given set of measurements.</div><div class="ttdef"><b>Definition:</b> csi.c:228</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a453fb28483754a8cb13acbe97f606731"><div class="ttname"><a href="structSRSRAN__API.html#a453fb28483754a8cb13acbe97f606731">SRSRAN_API::rnti</a></div><div class="ttdeci">uint16_t rnti</div><div class="ttdoc">UE temporal RNTI.</div><div class="ttdef"><b>Definition:</b> dci.h:71</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a995b7643d22b218f30b86f5e6d5f559b"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a995b7643d22b218f30b86f5e6d5f559b">srsue::nr::state::dl_metrics</a></div><div class="ttdeci">dl_metrics_t dl_metrics</div><div class="ttdef"><b>Definition:</b> state.h:64</div></div>
<div class="ttc" id="astructsrsue_1_1nr_1_1state_1_1pending__dl__grant__t_html_aecec2d1232fc364871e92eb2da835013"><div class="ttname"><a href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#aecec2d1232fc364871e92eb2da835013">srsue::nr::state::pending_dl_grant_t::enable</a></div><div class="ttdeci">bool enable</div><div class="ttdef"><b>Definition:</b> state.h:49</div></div>
<div class="ttc" id="aclasssrsran_1_1tti__semaphore_html"><div class="ttname"><a href="classsrsran_1_1tti__semaphore.html">srsran::tti_semaphore&lt; void * &gt;</a></div></div>
<div class="ttc" id="aue__ul__nr_8h_html_a9246bad921a9d3e3c21e19c2de01d098"><div class="ttname"><a href="ue__ul__nr_8h.html#a9246bad921a9d3e3c21e19c2de01d098">srsran_ue_ul_nr_sr_send_slot</a></div><div class="ttdeci">SRSRAN_API int srsran_ue_ul_nr_sr_send_slot(const srsran_pucch_nr_sr_resource_t sr_resources[SRSRAN_PUCCH_MAX_NOF_SR_RESOURCES], uint32_t slot_idx, uint32_t sr_resource_id[SRSRAN_PUCCH_MAX_NOF_SR_RESOURCES])</div><div class="ttdoc">Decides whether the provided slot index within the radio frame is a SR transmission opportunity.</div><div class="ttdef"><b>Definition:</b> ue_ul_nr.c:308</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a682bcef153ed00a3c13db2f61a5102ee"><div class="ttname"><a href="structSRSRAN__API.html#a682bcef153ed00a3c13db2f61a5102ee">SRSRAN_API::value</a></div><div class="ttdeci">srsran_uci_value_t value</div><div class="ttdef"><b>Definition:</b> uci_cfg.h:63</div></div>
<div class="ttc" id="astructSRSRAN__API_html_ae78da29ebcd5453cd1f31c3369304b2a"><div class="ttname"><a href="structSRSRAN__API.html#ae78da29ebcd5453cd1f31c3369304b2a">SRSRAN_API::configured</a></div><div class="ttdeci">bool configured</div><div class="ttdoc">Set to true when the fields have been configured, otherwise false.</div><div class="ttdef"><b>Definition:</b> refsignal_ul.h:69</div></div>
<div class="ttc" id="astructsrsue_1_1sync__metrics__t_html"><div class="ttname"><a href="structsrsue_1_1sync__metrics__t.html">srsue::sync_metrics_t</a></div><div class="ttdef"><b>Definition:</b> phy_metrics.h:42</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a2abcad4f612010b1add092b0b20a5dc6"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a2abcad4f612010b1add092b0b20a5dc6">srsue::nr::state::set_channel_metrics</a></div><div class="ttdeci">void set_channel_metrics(const ch_metrics_t &amp;m)</div><div class="ttdoc">Sets DL channel metrics from received CSI-RS resources.</div><div class="ttdef"><b>Definition:</b> state.h:417</div></div>
<div class="ttc" id="astructsrsran_1_1phy__cfg__nr__t_html_ad9fef5820d100dfc5665a6acc25a67d7"><div class="ttname"><a href="structsrsran_1_1phy__cfg__nr__t.html#ad9fef5820d100dfc5665a6acc25a67d7">srsran::phy_cfg_nr_t::get_pdsch_ack_resource</a></div><div class="ttdeci">bool get_pdsch_ack_resource(const srsran_dci_dl_nr_t &amp;dci_dl, srsran_harq_ack_resource_t &amp;ack_resource) const</div><div class="ttdoc">Get PDSCH ACK resource for a given PDSCH transmission.</div><div class="ttdef"><b>Definition:</b> phy_cfg_nr.cc:289</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a1640036e94423380563d2a8e5dfc7ca7"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a1640036e94423380563d2a8e5dfc7ca7">srsue::nr::state::get_pending_ack</a></div><div class="ttdeci">bool get_pending_ack(const uint32_t &amp;tti_tx, srsran_pdsch_ack_nr_t &amp;pdsch_ack)</div><div class="ttdef"><b>Definition:</b> state.h:274</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a3a167dff1d6e256b4b816236a64866e5"><div class="ttname"><a href="structSRSRAN__API.html#a3a167dff1d6e256b4b816236a64866e5">SRSRAN_API::snr_dB</a></div><div class="ttdeci">float snr_dB</div><div class="ttdoc">Signal to noise ratio in decibels.</div><div class="ttdef"><b>Definition:</b> phy_common_nr.h:510</div></div>
<div class="ttc" id="astructsrsue_1_1phy__args__nr__t_html"><div class="ttname"><a href="structsrsue_1_1phy__args__nr__t.html">srsue::phy_args_nr_t</a></div><div class="ttdef"><b>Definition:</b> ue_nr_interfaces.h:214</div></div>
<div class="ttc" id="astructsrsue_1_1phy__args__nr__t_html_a8d3d3e154389a5003ddcea19e779a27e"><div class="ttname"><a href="structsrsue_1_1phy__args__nr__t.html#a8d3d3e154389a5003ddcea19e779a27e">srsue::phy_args_nr_t::trs_sinr_ema_alpha</a></div><div class="ttdeci">float trs_sinr_ema_alpha</div><div class="ttdoc">SINR measurement exponential average alpha.</div><div class="ttdef"><b>Definition:</b> ue_nr_interfaces.h:231</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a3cf7b4d156c2893c54f15e6561c2076e"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a3cf7b4d156c2893c54f15e6561c2076e">srsue::nr::state::get_metrics</a></div><div class="ttdeci">void get_metrics(phy_metrics_t &amp;m)</div><div class="ttdoc">Appends the NR PHY metrics to the general metric hub.</div><div class="ttdef"><b>Definition:</b> state.h:456</div></div>
<div class="ttc" id="astructsrsue_1_1phy__args__nr__t_html_a3b1d4d318ee039901f99cfd637d80ab0"><div class="ttname"><a href="structsrsue_1_1phy__args__nr__t.html#a3b1d4d318ee039901f99cfd637d80ab0">srsue::phy_args_nr_t::trs_epre_ema_alpha</a></div><div class="ttdeci">float trs_epre_ema_alpha</div><div class="ttdoc">EPRE measurement exponential average alpha.</div><div class="ttdef"><b>Definition:</b> ue_nr_interfaces.h:229</div></div>
<div class="ttc" id="astructsrsran_1_1phy__cfg__nr__t_html_afe4f5d0dac97746a3b33e917d0bb7ed9"><div class="ttname"><a href="structsrsran_1_1phy__cfg__nr__t.html#afe4f5d0dac97746a3b33e917d0bb7ed9">srsran::phy_cfg_nr_t::pucch</a></div><div class="ttdeci">srsran_pucch_nr_hl_cfg_t pucch</div><div class="ttdef"><b>Definition:</b> phy_cfg_nr.h:53</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_af6a55cbcc1f56016068159d573543bcf"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#af6a55cbcc1f56016068159d573543bcf">srsue::nr::state::clear_pending_grants</a></div><div class="ttdeci">void clear_pending_grants()</div><div class="ttdef"><b>Definition:</b> state.h:313</div></div>
<div class="ttc" id="astructSRSRAN__API_html_ad3705c1da241123beac2fba29b8c0af5"><div class="ttname"><a href="structSRSRAN__API.html#ad3705c1da241123beac2fba29b8c0af5">SRSRAN_API::data</a></div><div class="ttdeci">srsran_csi_rs_nzp_resource_t data[SRSRAN_PHCH_CFG_MAX_NOF_CSI_RS_PER_SET]</div><div class="ttdoc">Resources.</div><div class="ttdef"><b>Definition:</b> csi_rs_cfg.h:118</div></div>
<div class="ttc" id="astructsrsue_1_1nr_1_1state_1_1pending__dl__grant__t_html_a18e67c345bff75c48423d71600bf9719"><div class="ttname"><a href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a18e67c345bff75c48423d71600bf9719">srsue::nr::state::pending_dl_grant_t::sch_cfg</a></div><div class="ttdeci">srsran_sch_cfg_nr_t sch_cfg</div><div class="ttdef"><b>Definition:</b> state.h:51</div></div>
<div class="ttc" id="astructsrsue_1_1ul__metrics__t_html"><div class="ttname"><a href="structsrsue_1_1ul__metrics__t.html">srsue::ul_metrics_t</a></div><div class="ttdef"><b>Definition:</b> phy_metrics.h:147</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a2ad2ed48275d0ea5cae9195e9f5f8a57"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a2ad2ed48275d0ea5cae9195e9f5f8a57">srsue::nr::state::get_dl_pending_grant</a></div><div class="ttdeci">bool get_dl_pending_grant(uint32_t tti_rx, srsran_sch_cfg_nr_t &amp;pdsch_cfg, srsran_harq_ack_resource_t &amp;ack_resource, uint32_t &amp;pid)</div><div class="ttdoc">Checks the DL pending grant list if there is any grant to receive for the given receive TTI.</div><div class="ttdef"><b>Definition:</b> state.h:218</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a2e51b7321e5671a1efc351529bddd83d"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a2e51b7321e5671a1efc351529bddd83d">srsue::nr::state::has_valid_sr_resource</a></div><div class="ttdeci">bool has_valid_sr_resource(const srsran::phy_cfg_nr_t &amp;cfg, uint32_t sr_id)</div><div class="ttdef"><b>Definition:</b> state.h:303</div></div>
<div class="ttc" id="astructSRSRAN__API_html_ad1805c987ba164b91075183e5dada7db"><div class="ttname"><a href="structSRSRAN__API.html#ad1805c987ba164b91075183e5dada7db">SRSRAN_API::nof_re</a></div><div class="ttdeci">uint32_t nof_re</div><div class="ttdoc">measurements</div><div class="ttdef"><b>Definition:</b> chest_dl.h:64</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a65c22efd981cab343ae01b09ab81147d"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a65c22efd981cab343ae01b09ab81147d">srsue::nr::state::info_metrics</a></div><div class="ttdeci">info_metrics_t info_metrics</div><div class="ttdoc">Metrics section.</div><div class="ttdef"><b>Definition:</b> state.h:61</div></div>
<div class="ttc" id="aclasssrsue_1_1mac__interface__phy__nr_html_aa99b0eb568e20ca593b0d628a3ddf64c"><div class="ttname"><a href="classsrsue_1_1mac__interface__phy__nr.html#aa99b0eb568e20ca593b0d628a3ddf64c">srsue::mac_interface_phy_nr::get_ul_sched_rnti_nr</a></div><div class="ttdeci">virtual sched_rnti_t get_ul_sched_rnti_nr(const uint32_t tti)=0</div></div>
<div class="ttc" id="astructSRSRAN__API_html_ada58b70f263a36969934f7a347d1ff61"><div class="ttname"><a href="structSRSRAN__API.html#ada58b70f263a36969934f7a347d1ff61">SRSRAN_API::sr_id</a></div><div class="ttdeci">uint32_t sr_id</div><div class="ttdoc">Scheduling Request identifier.</div><div class="ttdef"><b>Definition:</b> pucch_cfg_nr.h:164</div></div>
<div class="ttc" id="astructsrsue_1_1dl__metrics__t_html_a894e52b6dc2f10648b89f0a95539a6fb"><div class="ttname"><a href="structsrsue_1_1dl__metrics__t.html#a894e52b6dc2f10648b89f0a95539a6fb">srsue::dl_metrics_t::set</a></div><div class="ttdeci">void set(const dl_metrics_t &amp;other)</div><div class="ttdef"><b>Definition:</b> phy_metrics.h:127</div></div>
<div class="ttc" id="astructsrsran_1_1phy__cfg__nr__t_html_afd4ade189fe7efd5a295b9ddd0667d0e"><div class="ttname"><a href="structsrsran_1_1phy__cfg__nr__t.html#afd4ade189fe7efd5a295b9ddd0667d0e">srsran::phy_cfg_nr_t::csi</a></div><div class="ttdeci">srsran_csi_hl_cfg_t csi</div><div class="ttdef"><b>Definition:</b> phy_cfg_nr.h:57</div></div>
<div class="ttc" id="astructsrsran__harq__ack__resource__t_html"><div class="ttname"><a href="structsrsran__harq__ack__resource__t.html">srsran_harq_ack_resource_t</a></div><div class="ttdoc">Describes a HARQ ACK resource configuration.</div><div class="ttdef"><b>Definition:</b> harq_ack_cfg.h:37</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a1645a12dc0a979af75a9aaf76940e70c"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a1645a12dc0a979af75a9aaf76940e70c">srsue::nr::state::set_pending_ack</a></div><div class="ttdeci">void set_pending_ack(const uint32_t &amp;tti_rx, const srsran_harq_ack_resource_t &amp;ack_resource, const bool &amp;crc_ok)</div><div class="ttdoc">Stores a pending PDSCH ACK into the pending ACK list.</div><div class="ttdef"><b>Definition:</b> state.h:250</div></div>
<div class="ttc" id="anamespacesrsran_html_a4b0dc9d2ff01ae471b0192925a565b7da0ab3e5d0801aea3f3758bcbd812e8f10"><div class="ttname"><a href="namespacesrsran.html#a4b0dc9d2ff01ae471b0192925a565b7da0ab3e5d0801aea3f3758bcbd812e8f10">srsran::srsran_rat_t::nr</a></div><div class="ttdeci">@ nr</div></div>
<div class="ttc" id="astructsrsue_1_1sync__metrics__t_html_afd4ddbfa1006779906272d701ea2cd47"><div class="ttname"><a href="structsrsue_1_1sync__metrics__t.html#afd4ddbfa1006779906272d701ea2cd47">srsue::sync_metrics_t::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdef"><b>Definition:</b> phy_metrics.h:61</div></div>
<div class="ttc" id="ara__ul__nr_8h_html_a1729e74ca5ab3c4448643b28e62f14ca"><div class="ttname"><a href="ra__ul__nr_8h.html#a1729e74ca5ab3c4448643b28e62f14ca">srsran_ra_ul_nr_nof_sr_bits</a></div><div class="ttdeci">SRSRAN_API uint32_t srsran_ra_ul_nr_nof_sr_bits(uint32_t K)</div><div class="ttdoc">Computes the number of SR bits.</div><div class="ttdef"><b>Definition:</b> ra_ul_nr.c:721</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_acd033ae1fb912147bd987cf940cdc27a"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#acd033ae1fb912147bd987cf940cdc27a">srsue::nr::state::reset_metrics</a></div><div class="ttdeci">void reset_metrics()</div><div class="ttdoc">Resets all metrics (protected)</div><div class="ttdef"><b>Definition:</b> state.h:446</div></div>
<div class="ttc" id="acsi_8h_html_aa6656effec046c2bed6c3ee2dbd2151c"><div class="ttname"><a href="csi_8h.html#aa6656effec046c2bed6c3ee2dbd2151c">srsran_csi_reports_generate</a></div><div class="ttdeci">SRSRAN_API int srsran_csi_reports_generate(const srsran_csi_hl_cfg_t *cfg, const srsran_slot_cfg_t *slot_cfg, srsran_csi_report_cfg_t report_cfg[SRSRAN_CSI_SLOT_MAX_NOF_REPORT])</div><div class="ttdoc">Generates CSI report configuration from the higher layer configuration for a given slot.</div><div class="ttdef"><b>Definition:</b> csi.c:189</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a2ec243a32a91ddb9335831bd23d18f23"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a2ec243a32a91ddb9335831bd23d18f23">srsue::nr::state::pending_ack</a></div><div class="ttdeci">srsran::circular_array&lt; srsran_pdsch_ack_nr_t, TTIMOD_SZ &gt; pending_ack</div><div class="ttdef"><b>Definition:</b> state.h:57</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_ad82f70344d4d65ad55e49a20af9e6e86"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#ad82f70344d4d65ad55e49a20af9e6e86">srsue::nr::state::get_periodic_csi</a></div><div class="ttdeci">void get_periodic_csi(const srsran::phy_cfg_nr_t &amp;cfg, const srsran_slot_cfg_t &amp;slot_cfg, srsran_uci_data_nr_t &amp;uci_data)</div><div class="ttdef"><b>Definition:</b> state.h:366</div></div>
<div class="ttc" id="astructsrsue_1_1phy__args__nr__t_html_aced50a77c8422eccdaeaedc707261ece"><div class="ttname"><a href="structsrsue_1_1phy__args__nr__t.html#aced50a77c8422eccdaeaedc707261ece">srsue::phy_args_nr_t::trs_cfo_ema_alpha</a></div><div class="ttdeci">float trs_cfo_ema_alpha</div><div class="ttdoc">RSRP measurement exponential average alpha.</div><div class="ttdef"><b>Definition:</b> ue_nr_interfaces.h:232</div></div>
<div class="ttc" id="astructsrsue_1_1ul__metrics__t_html_ac5dae2a30bb6d516b4348a566312ad34"><div class="ttname"><a href="structsrsue_1_1ul__metrics__t.html#ac5dae2a30bb6d516b4348a566312ad34">srsue::ul_metrics_t::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdef"><b>Definition:</b> phy_metrics.h:160</div></div>
<div class="ttc" id="astructsrsue_1_1nr_1_1state_1_1pending__dl__grant__t_html"><div class="ttname"><a href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html">srsue::nr::state::pending_dl_grant_t</a></div><div class="ttdef"><b>Definition:</b> state.h:48</div></div>
<div class="ttc" id="anamespacesrsue_html"><div class="ttname"><a href="namespacesrsue.html">srsue</a></div><div class="ttdoc">Common definitions/interfaces between LTE/NR MAC components.</div><div class="ttdef"><b>Definition:</b> bearer_manager.h:79</div></div>
<div class="ttc" id="astructsrsran__harq__ack__resource__t_html_a9f6d58e37cc5b0990150537d65a19d45"><div class="ttname"><a href="structsrsran__harq__ack__resource__t.html#a9f6d58e37cc5b0990150537d65a19d45">srsran_harq_ack_resource_t::k1</a></div><div class="ttdeci">uint32_t k1</div><div class="ttdoc">HARQ feedback timing.</div><div class="ttdef"><b>Definition:</b> harq_ack_cfg.h:41</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_aaaa794f95b78e973825b396484f2dc20"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#aaaa794f95b78e973825b396484f2dc20">srsue::nr::state::get_ul_pending_grant</a></div><div class="ttdeci">bool get_ul_pending_grant(uint32_t tti_tx, srsran_sch_cfg_nr_t &amp;pusch_cfg, uint32_t &amp;pid)</div><div class="ttdoc">Checks the UL pending grant list if there is any grant to transmit for the given transmit TTI.</div><div class="ttdef"><b>Definition:</b> state.h:147</div></div>
<div class="ttc" id="astructsrsue_1_1info__metrics__t_html"><div class="ttname"><a href="structsrsue_1_1info__metrics__t.html">srsue::info_metrics_t</a></div><div class="ttdef"><b>Definition:</b> phy_metrics.h:30</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a576a89f5ef2142a0100290be9ae1a813"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a576a89f5ef2142a0100290be9ae1a813">srsue::nr::state::set_dl_pending_grant</a></div><div class="ttdeci">void set_dl_pending_grant(const srsran::phy_cfg_nr_t &amp;cfg, const srsran_slot_cfg_t &amp;slot, const srsran_dci_dl_nr_t &amp;dci_dl)</div><div class="ttdoc">Stores a received DL DCI into the pending DL grant list.</div><div class="ttdef"><b>Definition:</b> state.h:177</div></div>
<div class="ttc" id="avector_8h_html_a182c1cf7e5f1874d4d5ece461860f815"><div class="ttname"><a href="vector_8h.html#a182c1cf7e5f1874d4d5ece461860f815">SRSRAN_VEC_SAFE_EMA</a></div><div class="ttdeci">#define SRSRAN_VEC_SAFE_EMA(data, average, alpha)</div><div class="ttdef"><b>Definition:</b> vector.h:90</div></div>
<div class="ttc" id="aclasssrsran_1_1circular__array_html"><div class="ttname"><a href="classsrsran_1_1circular__array.html">srsran::circular_array</a></div><div class="ttdef"><b>Definition:</b> circular_array.h:43</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a01452349a32cf55b77c2e82c8cd16ed3"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a01452349a32cf55b77c2e82c8cd16ed3">srsue::nr::state::set_ul_metrics</a></div><div class="ttdeci">void set_ul_metrics(const ul_metrics_t &amp;m)</div><div class="ttdoc">Sets UL metrics of a given PUSCH transmission.</div><div class="ttdef"><b>Definition:</b> state.h:437</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a18ea71cae80d86c130c45a3735c77fdb"><div class="ttname"><a href="structSRSRAN__API.html#a18ea71cae80d86c130c45a3735c77fdb">SRSRAN_API::cfo_hz</a></div><div class="ttdeci">float cfo_hz</div><div class="ttdoc">CFO in Hz.</div><div class="ttdef"><b>Definition:</b> chest_ul.h:69</div></div>
<div class="ttc" id="apucch__cfg__nr_8h_html_a231c1d77814b53c9d8b9b8f535f387cb"><div class="ttname"><a href="pucch__cfg__nr_8h.html#a231c1d77814b53c9d8b9b8f535f387cb">SRSRAN_PUCCH_MAX_NOF_SR_RESOURCES</a></div><div class="ttdeci">#define SRSRAN_PUCCH_MAX_NOF_SR_RESOURCES</div><div class="ttdef"><b>Definition:</b> pucch_cfg_nr.h:92</div></div>
<div class="ttc" id="acsi_8h_html_a195c8274a3ed7b354e9f9aeb8fffe22e"><div class="ttname"><a href="csi_8h.html#a195c8274a3ed7b354e9f9aeb8fffe22e">srsran_csi_new_nzp_csi_rs_measurement</a></div><div class="ttdeci">SRSRAN_API int srsran_csi_new_nzp_csi_rs_measurement(const srsran_csi_hl_resource_cfg_t csi_resources[SRSRAN_CSI_MAX_NOF_RESOURCES], srsran_csi_channel_measurements_t measurements[SRSRAN_CSI_MAX_NOF_RESOURCES], const srsran_csi_channel_measurements_t *new_measure, uint32_t nzp_csi_rs_id)</div><div class="ttdoc">Processes a new NZP-CSI-RS channel measurement, it maps the given measurement into the current measur...</div><div class="ttdef"><b>Definition:</b> csi.c:143</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a814c1340cefe851e2c57c2cc2964b3a5"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a814c1340cefe851e2c57c2cc2964b3a5">srsue::nr::state::reset_measurements</a></div><div class="ttdeci">void reset_measurements()</div><div class="ttdoc">Resets all PHY measurements (protected)</div><div class="ttdef"><b>Definition:</b> state.h:475</div></div>
<div class="ttc" id="astructsrsue_1_1ul__metrics__t_html_a74d0f13f36c3c2e037c40f7ddf59696c"><div class="ttname"><a href="structsrsue_1_1ul__metrics__t.html#a74d0f13f36c3c2e037c40f7ddf59696c">srsue::ul_metrics_t::set</a></div><div class="ttdeci">void set(const ul_metrics_t &amp;other)</div><div class="ttdef"><b>Definition:</b> phy_metrics.h:153</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a37bc734337087668b5c3be5cd7b9d806"><div class="ttname"><a href="structSRSRAN__API.html#a37bc734337087668b5c3be5cd7b9d806">SRSRAN_API::sr_resources</a></div><div class="ttdeci">srsran_pucch_nr_sr_resource_t sr_resources[SRSRAN_PUCCH_MAX_NOF_SR_RESOURCES]</div><div class="ttdoc">SR resources, indexed by identifier.</div><div class="ttdef"><b>Definition:</b> pucch_cfg_nr.h:176</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_ac7dd5bcc67a6e59ad73f8b75071fcf19"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#ac7dd5bcc67a6e59ad73f8b75071fcf19">srsue::nr::state::trs_measurements</a></div><div class="ttdeci">srsran_csi_trs_measurements_t trs_measurements</div><div class="ttdef"><b>Definition:</b> state.h:74</div></div>
<div class="ttc" id="astructsrsue_1_1nr_1_1state_1_1pending__ul__grant__t_html_a12692e4a938e406661801871d9563fc4"><div class="ttname"><a href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#a12692e4a938e406661801871d9563fc4">srsue::nr::state::pending_ul_grant_t::pid</a></div><div class="ttdeci">uint32_t pid</div><div class="ttdef"><b>Definition:</b> state.h:42</div></div>
<div class="ttc" id="apdsch__ue_8c_html_af56ee4ac13bcfa2f70ad4cbb1d506422"><div class="ttname"><a href="pdsch__ue_8c.html#af56ee4ac13bcfa2f70ad4cbb1d506422">pdsch_cfg</a></div><div class="ttdeci">srsran_pdsch_cfg_t pdsch_cfg</div><div class="ttdef"><b>Definition:</b> pdsch_ue.c:372</div></div>
<div class="ttc" id="adci__nr_8h_html_ab92800edbdf3d678ea6fe90a5c538b0f"><div class="ttname"><a href="dci__nr_8h.html#ab92800edbdf3d678ea6fe90a5c538b0f">srsran_dci_dl_nr_to_str</a></div><div class="ttdeci">SRSRAN_API uint32_t srsran_dci_dl_nr_to_str(const srsran_dci_nr_t *q, const srsran_dci_dl_nr_t *dci, char *str, uint32_t str_len)</div><div class="ttdoc">Stringifies a DL NR DCI structure.</div><div class="ttdef"><b>Definition:</b> dci_nr.c:2125</div></div>
<div class="ttc" id="astructsrsue_1_1dl__metrics__t_html_a25b448eee03a427fe8d32ad69e8293eb"><div class="ttname"><a href="structsrsue_1_1dl__metrics__t.html#a25b448eee03a427fe8d32ad69e8293eb">srsue::dl_metrics_t::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdef"><b>Definition:</b> phy_metrics.h:135</div></div>
<div class="ttc" id="astructsrsue_1_1ch__metrics__t_html_aede4ba0c05a28e8347153209015e70d3"><div class="ttname"><a href="structsrsue_1_1ch__metrics__t.html#aede4ba0c05a28e8347153209015e70d3">srsue::ch_metrics_t::sync_err</a></div><div class="ttdeci">float sync_err</div><div class="ttdef"><b>Definition:</b> phy_metrics.h:85</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a05bf6d40d528e36f019020070aec1c34"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a05bf6d40d528e36f019020070aec1c34">srsue::nr::state::set_ul_ext_cfo</a></div><div class="ttdeci">void set_ul_ext_cfo(float ext_cfo_hz)</div><div class="ttdef"><b>Definition:</b> state.h:563</div></div>
<div class="ttc" id="acsi__cfg_8h_html_a30dbfab261dd8f818d3b353015c3c30ea5f2e9d7c40f1a67c9b7615ce276dc240"><div class="ttname"><a href="csi__cfg_8h.html#a30dbfab261dd8f818d3b353015c3c30ea5f2e9d7c40f1a67c9b7615ce276dc240">SRSRAN_CSI_REPORT_QUANTITY_CRI_RI_PMI_CQI</a></div><div class="ttdeci">@ SRSRAN_CSI_REPORT_QUANTITY_CRI_RI_PMI_CQI</div><div class="ttdef"><b>Definition:</b> csi_cfg.h:76</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a0b36e67d61d540b0baba0d149b7430ea"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a0b36e67d61d540b0baba0d149b7430ea">srsue::nr::state::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdef"><b>Definition:</b> state.h:296</div></div>
<div class="ttc" id="astructsrsran_1_1phy__cfg__nr__t_html_ac728ba697476cb9fc8b2fd22aa2091f3"><div class="ttname"><a href="structsrsran_1_1phy__cfg__nr__t.html#ac728ba697476cb9fc8b2fd22aa2091f3">srsran::phy_cfg_nr_t::get_pdsch_cfg</a></div><div class="ttdeci">bool get_pdsch_cfg(const srsran_slot_cfg_t &amp;slot_cfg, const srsran_dci_dl_nr_t &amp;dci, srsran_sch_cfg_nr_t &amp;pdsch_cfg) const</div><div class="ttdoc">Get PDSCH configuration for a given slot and DCI.</div><div class="ttdef"><b>Definition:</b> phy_cfg_nr.cc:273</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a815ce59bdad2df67934e5b2e76a6f62a"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a815ce59bdad2df67934e5b2e76a6f62a">srsue::nr::state::get_dl_cfo</a></div><div class="ttdeci">float get_dl_cfo()</div><div class="ttdef"><b>Definition:</b> state.h:551</div></div>
<div class="ttc" id="astructsrsue_1_1nr_1_1state_1_1pending__ul__grant__t_html_a1973a1bc5d5c6f4cb1f9e6e8e4e53f99"><div class="ttname"><a href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html#a1973a1bc5d5c6f4cb1f9e6e8e4e53f99">srsue::nr::state::pending_ul_grant_t::enable</a></div><div class="ttdeci">bool enable</div><div class="ttdef"><b>Definition:</b> state.h:41</div></div>
<div class="ttc" id="astructsrsran__harq__ack__m__t_html_accc3ee5f5db7b647df8da35f8bf9d416"><div class="ttname"><a href="structsrsran__harq__ack__m__t.html#accc3ee5f5db7b647df8da35f8bf9d416">srsran_harq_ack_m_t::value</a></div><div class="ttdeci">uint8_t value[SRSRAN_MAX_CODEWORDS]</div><div class="ttdef"><b>Definition:</b> harq_ack_cfg.h:53</div></div>
<div class="ttc" id="astructSRSRAN__API_html"><div class="ttname"><a href="structSRSRAN__API.html">SRSRAN_API</a></div><div class="ttdoc">CFR module configuration arguments.</div><div class="ttdef"><b>Definition:</b> agc.h:68</div></div>
<div class="ttc" id="astructsrsue_1_1nr_1_1state_1_1pending__ul__grant__t_html"><div class="ttname"><a href="structsrsue_1_1nr_1_1state_1_1pending__ul__grant__t.html">srsue::nr::state::pending_ul_grant_t</a></div><div class="ttdef"><b>Definition:</b> state.h:40</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a37f91f6abcce1cd60aea7c00c7d4b677"><div class="ttname"><a href="structSRSRAN__API.html#a37f91f6abcce1cd60aea7c00c7d4b677">SRSRAN_API::sr</a></div><div class="ttdeci">uint32_t sr</div><div class="ttdoc">Number of positive SR.</div><div class="ttdef"><b>Definition:</b> uci_cfg_nr.h:96</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a8832b1e822846d912c9d001ede7172c5"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a8832b1e822846d912c9d001ede7172c5">srsue::nr::state::stack</a></div><div class="ttdeci">mac_interface_phy_nr * stack</div><div class="ttdef"><b>Definition:</b> state.h:91</div></div>
<div class="ttc" id="astructSRSRAN__API_html_aa9a40b267774e99d7c3f76895dcff4af"><div class="ttname"><a href="structSRSRAN__API.html#aa9a40b267774e99d7c3f76895dcff4af">SRSRAN_API::wideband_epre_dBm</a></div><div class="ttdeci">float wideband_epre_dBm</div><div class="ttdoc">Measured EPRE.</div><div class="ttdef"><b>Definition:</b> csi_cfg.h:169</div></div>
<div class="ttc" id="astructsrsue_1_1sync__metrics__t_html_a9de8466d903846bcb8d1aa4ad2a9d82a"><div class="ttname"><a href="structsrsue_1_1sync__metrics__t.html#a9de8466d903846bcb8d1aa4ad2a9d82a">srsue::sync_metrics_t::cfo</a></div><div class="ttdeci">float cfo</div><div class="ttdef"><b>Definition:</b> phy_metrics.h:48</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_af403ff4ff52d7fe9af7f20f3f8096106"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#af403ff4ff52d7fe9af7f20f3f8096106">srsue::nr::state::set_ul_pending_grant</a></div><div class="ttdeci">void set_ul_pending_grant(const srsran::phy_cfg_nr_t &amp;cfg, const srsran_slot_cfg_t &amp;slot_rx, const srsran_dci_ul_nr_t &amp;dci_ul)</div><div class="ttdoc">Stores a received UL DCI into the pending UL grant list.</div><div class="ttdef"><b>Definition:</b> state.h:114</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a3c3bfb783355589968de3f45b4e647ff"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a3c3bfb783355589968de3f45b4e647ff">srsue::nr::state::get_ul_cfo</a></div><div class="ttdeci">float get_ul_cfo() const</div><div class="ttdef"><b>Definition:</b> state.h:557</div></div>
<div class="ttc" id="anpdcch__file__test_8c_html_a889c172169d7aa27ba5942efe7dbee83"><div class="ttname"><a href="npdcch__file__test_8c.html#a889c172169d7aa27ba5942efe7dbee83">tti</a></div><div class="ttdeci">uint32_t tti</div><div class="ttdef"><b>Definition:</b> npdcch_file_test.c:38</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a5ec642b321a3aa3f2865d4be6455260b"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a5ec642b321a3aa3f2865d4be6455260b">srsue::nr::state::args</a></div><div class="ttdeci">phy_args_nr_t args</div><div class="ttdoc">Physical layer user configuration.</div><div class="ttdef"><b>Definition:</b> state.h:94</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_aa8849a969d7ce49d7b3e5f43d57d3ce1"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#aa8849a969d7ce49d7b3e5f43d57d3ce1">srsue::nr::state::csi_measurements</a></div><div class="ttdeci">std::array&lt; srsran_csi_channel_measurements_t, SRSRAN_CSI_MAX_NOF_RESOURCES &gt; csi_measurements</div><div class="ttdef"><b>Definition:</b> state.h:70</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_abb7424b02a0e5298fe56493d93e5af79"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#abb7424b02a0e5298fe56493d93e5af79">srsue::nr::state::pending_dl_grant_mutex</a></div><div class="ttdeci">std::mutex pending_dl_grant_mutex</div><div class="ttdef"><b>Definition:</b> state.h:55</div></div>
<div class="ttc" id="adci__nr_8h_html_a2e81ebc47012bd4cb7031936defa07ce"><div class="ttname"><a href="dci__nr_8h.html#a2e81ebc47012bd4cb7031936defa07ce">srsran_dci_ul_nr_to_str</a></div><div class="ttdeci">SRSRAN_API uint32_t srsran_dci_ul_nr_to_str(const srsran_dci_nr_t *q, const srsran_dci_ul_nr_t *dci, char *str, uint32_t str_len)</div><div class="ttdoc">Stringifies an UL NR DCI structure.</div><div class="ttdef"><b>Definition:</b> dci_nr.c:2096</div></div>
<div class="ttc" id="astructsrsue_1_1phy__args__nr__t_html_a2fa097ea0b3e836e97b5b38507998180"><div class="ttname"><a href="structsrsue_1_1phy__args__nr__t.html#a2fa097ea0b3e836e97b5b38507998180">srsue::phy_args_nr_t::fixed_sr</a></div><div class="ttdeci">std::set&lt; uint32_t &gt; fixed_sr</div><div class="ttdef"><b>Definition:</b> ue_nr_interfaces.h:226</div></div>
<div class="ttc" id="aclasssrsue_1_1mac__interface__phy__nr_html_a5a7a89995b716397052b6a3b36a736b3"><div class="ttname"><a href="classsrsue_1_1mac__interface__phy__nr.html#a5a7a89995b716397052b6a3b36a736b3">srsue::mac_interface_phy_nr::sr_opportunity</a></div><div class="ttdeci">virtual bool sr_opportunity(uint32_t tti, uint32_t sr_id, bool meas_gap, bool ul_sch_tx)=0</div><div class="ttdoc">Indicate a valid SR transmission occasion on the valid PUCCH resource for SR configured; and the SR t...</div></div>
<div class="ttc" id="astructSRSRAN__API_html_ac5013770670001287f48aae6cde102b2"><div class="ttname"><a href="structSRSRAN__API.html#ac5013770670001287f48aae6cde102b2">SRSRAN_API::wideband_snr_db</a></div><div class="ttdeci">float wideband_snr_db</div><div class="ttdoc">SNR calculated from NZP-CSI-RS RSRP and EPRE (Ignore for IM-CSI-RS)</div><div class="ttdef"><b>Definition:</b> csi_cfg.h:170</div></div>
<div class="ttc" id="astructsrsue_1_1ch__metrics__t_html_a62789b30987b7d7c5d0a8890bcddca8a"><div class="ttname"><a href="structsrsue_1_1ch__metrics__t.html#a62789b30987b7d7c5d0a8890bcddca8a">srsue::ch_metrics_t::sinr</a></div><div class="ttdeci">float sinr</div><div class="ttdef"><b>Definition:</b> phy_metrics.h:79</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a409be00b694fce56bc1847e76826db15"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a409be00b694fce56bc1847e76826db15">srsue::nr::state::pending_ul_grant_mutex</a></div><div class="ttdeci">std::mutex pending_ul_grant_mutex</div><div class="ttdef"><b>Definition:</b> state.h:46</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_aeb03433bdd0494f672bebded74a38c03"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#aeb03433bdd0494f672bebded74a38c03">srsue::nr::state::reset_metrics_</a></div><div class="ttdeci">void reset_metrics_()</div><div class="ttdoc">Resets all metrics (unprotected)</div><div class="ttdef"><b>Definition:</b> state.h:82</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a138942764c8e8ba32a7ec7e3ebd6667e"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a138942764c8e8ba32a7ec7e3ebd6667e">srsue::nr::state::metrics_mutex</a></div><div class="ttdeci">std::mutex metrics_mutex</div><div class="ttdef"><b>Definition:</b> state.h:66</div></div>
<div class="ttc" id="astructsrsue_1_1nr_1_1state_1_1pending__dl__grant__t_html_a0a9295bbef96fa4a6087191580274f24"><div class="ttname"><a href="structsrsue_1_1nr_1_1state_1_1pending__dl__grant__t.html#a0a9295bbef96fa4a6087191580274f24">srsue::nr::state::pending_dl_grant_t::pid</a></div><div class="ttdeci">uint32_t pid</div><div class="ttdef"><b>Definition:</b> state.h:50</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a5166327513cb1397f4ef1db5562ab016"><div class="ttname"><a href="structSRSRAN__API.html#a5166327513cb1397f4ef1db5562ab016">SRSRAN_API::o_sr</a></div><div class="ttdeci">uint32_t o_sr</div><div class="ttdoc">Number of SR bits.</div><div class="ttdef"><b>Definition:</b> uci_cfg_nr.h:81</div></div>
<div class="ttc" id="astructsrsran__pdsch__ack__nr__t_html_a645a709422915993c92965ece2488db9"><div class="ttname"><a href="structsrsran__pdsch__ack__nr__t.html#a645a709422915993c92965ece2488db9">srsran_pdsch_ack_nr_t::nof_cc</a></div><div class="ttdeci">uint32_t nof_cc</div><div class="ttdef"><b>Definition:</b> harq_ack_cfg.h:78</div></div>
<div class="ttc" id="astructsrsran__pdsch__ack__nr__t_html"><div class="ttname"><a href="structsrsran__pdsch__ack__nr__t.html">srsran_pdsch_ack_nr_t</a></div><div class="ttdoc">Describes a collection of PDSCH HARQ ACK feedback for a number of component carriers.</div><div class="ttdef"><b>Definition:</b> harq_ack_cfg.h:76</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a2234f49a90ddaf128c2cbca8c17ab588"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a2234f49a90ddaf128c2cbca8c17ab588">srsue::nr::state::pending_ul_grant</a></div><div class="ttdeci">srsran::circular_array&lt; pending_ul_grant_t, TTIMOD_SZ &gt; pending_ul_grant</div><div class="ttdef"><b>Definition:</b> state.h:45</div></div>
<div class="ttc" id="aCMakeCache_8txt_html_ab3cd915d758008bd19d0f2428fbb354a"><div class="ttname"><a href="CMakeCache_8txt.html#ab3cd915d758008bd19d0f2428fbb354a">m</a></div><div class="ttdeci">m</div><div class="ttdef"><b>Definition:</b> CMakeCache.txt:684</div></div>
<div class="ttc" id="acircular__array_8h_html"><div class="ttname"><a href="circular__array_8h.html">circular_array.h</a></div><div class="ttdoc">Helper class to safely access elements of a std::array.</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a5a3e3250451afcba94ca4851a375e8bc"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a5a3e3250451afcba94ca4851a375e8bc">srsue::nr::state::state</a></div><div class="ttdeci">state()</div><div class="ttdef"><b>Definition:</b> state.h:99</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a376f588172a6a7174619a47d3054696e"><div class="ttname"><a href="structSRSRAN__API.html#a376f588172a6a7174619a47d3054696e">SRSRAN_API::sr_positive_present</a></div><div class="ttdeci">bool sr_positive_present</div><div class="ttdoc">Set to true if there is at least one positive SR.</div><div class="ttdef"><b>Definition:</b> uci_cfg_nr.h:82</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_af367acfa7c9f61585e7511aa5246a3f6"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#af367acfa7c9f61585e7511aa5246a3f6">srsue::nr::state::sync_metrics</a></div><div class="ttdeci">sync_metrics_t sync_metrics</div><div class="ttdef"><b>Definition:</b> state.h:62</div></div>
<div class="ttc" id="acommon_2common_8h_html_a5b6441bc63ac58ce10deed94870fe989"><div class="ttname"><a href="common_2common_8h.html#a5b6441bc63ac58ce10deed94870fe989">TTI_TX</a></div><div class="ttdeci">#define TTI_TX(tti)</div><div class="ttdef"><b>Definition:</b> common.h:55</div></div>
<div class="ttc" id="astructSRSRAN__API_html_ad66a75bd892aea256523de710ed872d6"><div class="ttname"><a href="structSRSRAN__API.html#ad66a75bd892aea256523de710ed872d6">SRSRAN_API::cri</a></div><div class="ttdeci">uint32_t cri</div><div class="ttdoc">CSI-RS Resource Indicator.</div><div class="ttdef"><b>Definition:</b> csi_cfg.h:167</div></div>
<div class="ttc" id="adebug_8h_html_aff62ee963c9ecc544894676b842e9491"><div class="ttname"><a href="debug_8h.html#aff62ee963c9ecc544894676b842e9491">ERROR</a></div><div class="ttdeci">#define ERROR(_fmt,...)</div><div class="ttdef"><b>Definition:</b> debug.h:85</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html">srsue::nr::state</a></div><div class="ttdef"><b>Definition:</b> state.h:37</div></div>
<div class="ttc" id="astructsrsran_1_1phy__cfg__nr__t_html_a1d7eb497cdfa3a514c6dd9625dbec358"><div class="ttname"><a href="structsrsran_1_1phy__cfg__nr__t.html#a1d7eb497cdfa3a514c6dd9625dbec358">srsran::phy_cfg_nr_t::get_pusch_cfg</a></div><div class="ttdeci">bool get_pusch_cfg(const srsran_slot_cfg_t &amp;slot_cfg, const srsran_dci_ul_nr_t &amp;dci, srsran_sch_cfg_nr_t &amp;pdsch_cfg) const</div><div class="ttdoc">Get PUSCH configuration for a given slot and DCI.</div><div class="ttdef"><b>Definition:</b> phy_cfg_nr.cc:281</div></div>
<div class="ttc" id="asrsran_8h_html"><div class="ttname"><a href="srsran_8h.html">srsran.h</a></div></div>
<div class="ttc" id="astructsrsue_1_1ch__metrics__t_html_af2f74e8ad4213adbcee356408d2b4bbf"><div class="ttname"><a href="structsrsue_1_1ch__metrics__t.html#af2f74e8ad4213adbcee356408d2b4bbf">srsue::ch_metrics_t::set</a></div><div class="ttdeci">void set(const ch_metrics_t &amp;other)</div><div class="ttdef"><b>Definition:</b> phy_metrics.h:87</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a8198636af20c946c582c87bb21b8113e"><div class="ttname"><a href="structSRSRAN__API.html#a8198636af20c946c582c87bb21b8113e">SRSRAN_API::grant</a></div><div class="ttdeci">srsran_ra_nbiot_dl_grant_t grant</div><div class="ttdef"><b>Definition:</b> npdsch_cfg.h:33</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a2174b300cb11c9b3c9820e60956cbafb"><div class="ttname"><a href="structSRSRAN__API.html#a2174b300cb11c9b3c9820e60956cbafb">SRSRAN_API::k</a></div><div class="ttdeci">uint32_t k</div><div class="ttdoc">Time domain resources.</div><div class="ttdef"><b>Definition:</b> phch_cfg_nr.h:104</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a855200674c8d97304fc172c3248c4713"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a855200674c8d97304fc172c3248c4713">srsue::nr::state::set_sync_metrics</a></div><div class="ttdeci">void set_sync_metrics(const sync_metrics_t &amp;m)</div><div class="ttdoc">Sets time and frequency synchronization metrics.</div><div class="ttdef"><b>Definition:</b> state.h:407</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a9051fbab45675e961b36fc722745db5a"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a9051fbab45675e961b36fc722745db5a">srsue::nr::state::new_csi_trs_measurement</a></div><div class="ttdeci">void new_csi_trs_measurement(const srsran_csi_trs_measurements_t &amp;new_meas, const srsran::phy_cfg_nr_t &amp;cfg, uint32_t resource_set_id=0, uint32_t K_csi_rs=0)</div><div class="ttdoc">Processes a new Tracking Reference Signal (TRS) measurement.</div><div class="ttdef"><b>Definition:</b> state.h:509</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a906ab09fe03202c5d622d440279114c9"><div class="ttname"><a href="structSRSRAN__API.html#a906ab09fe03202c5d622d440279114c9">SRSRAN_API::epre_dB</a></div><div class="ttdeci">float epre_dB</div><div class="ttdoc">Logarithm scale EPRE relative to full-scale.</div><div class="ttdef"><b>Definition:</b> phy_common_nr.h:507</div></div>
<div class="ttc" id="astructsrsue_1_1phy__args__nr__t_html_a7e82c8d92cbc0f443a621d0189f5d4d5"><div class="ttname"><a href="structsrsue_1_1phy__args__nr__t.html#a7e82c8d92cbc0f443a621d0189f5d4d5">srsue::phy_args_nr_t::trs_rsrp_ema_alpha</a></div><div class="ttdeci">float trs_rsrp_ema_alpha</div><div class="ttdoc">RSRP measurement exponential average alpha.</div><div class="ttdef"><b>Definition:</b> ue_nr_interfaces.h:230</div></div>
<div class="ttc" id="astructSRSRAN__API_html_aadcee8fd26f02ba7684267ad1705cd68"><div class="ttname"><a href="structSRSRAN__API.html#aadcee8fd26f02ba7684267ad1705cd68">SRSRAN_API::K_csi_rs</a></div><div class="ttdeci">uint32_t K_csi_rs</div><div class="ttdoc">Number of CSI-RS in the corresponding resource set.</div><div class="ttdef"><b>Definition:</b> csi_cfg.h:174</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a4623e224fada2fa93b1044f5d5d5331f"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a4623e224fada2fa93b1044f5d5d5331f">srsue::nr::state::set_dl_metrics</a></div><div class="ttdeci">void set_dl_metrics(const dl_metrics_t &amp;m)</div><div class="ttdoc">Sets DL metrics of a given PDSCH transmission.</div><div class="ttdef"><b>Definition:</b> state.h:427</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a2dd0c7cedacf51cb5b8080789c358c6e"><div class="ttname"><a href="structSRSRAN__API.html#a2dd0c7cedacf51cb5b8080789c358c6e">SRSRAN_API::csi</a></div><div class="ttdeci">float * csi[SRSRAN_MAX_CODEWORDS]</div><div class="ttdef"><b>Definition:</b> pdsch.h:72</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a4b18e6c6cafe5356dfde37eae28fc2d4"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a4b18e6c6cafe5356dfde37eae28fc2d4">srsue::nr::state::get_pending_sr</a></div><div class="ttdeci">void get_pending_sr(const srsran::phy_cfg_nr_t &amp;cfg, const uint32_t &amp;tti, srsran_uci_data_nr_t &amp;uci_data)</div><div class="ttdef"><b>Definition:</b> state.h:331</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a11dc9f4b7025073bb21bffbd55448428"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a11dc9f4b7025073bb21bffbd55448428">srsue::nr::state::ch_metrics</a></div><div class="ttdeci">ch_metrics_t ch_metrics</div><div class="ttdef"><b>Definition:</b> state.h:63</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a27163182ff61aa6a8fad2297f8912916"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a27163182ff61aa6a8fad2297f8912916">srsue::nr::state::ul_ext_cfo_hz</a></div><div class="ttdeci">std::atomic&lt; float &gt; ul_ext_cfo_hz</div><div class="ttdoc">Other measurements.</div><div class="ttdef"><b>Definition:</b> state.h:77</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a59456e1c38b3419f1af9ab7b7e966921"><div class="ttname"><a href="structSRSRAN__API.html#a59456e1c38b3419f1af9ab7b7e966921">SRSRAN_API::pucch</a></div><div class="ttdeci">srsran_pucch_t pucch</div><div class="ttdef"><b>Definition:</b> enb_ul.h:71</div></div>
<div class="ttc" id="aconfig_8h_html_adfad7b94311dafac5a16dec17b4ab20d"><div class="ttname"><a href="config_8h.html#adfad7b94311dafac5a16dec17b4ab20d">SRSRAN_SUCCESS</a></div><div class="ttdeci">#define SRSRAN_SUCCESS</div><div class="ttdef"><b>Definition:</b> config.h:57</div></div>
<div class="ttc" id="astructsrsue_1_1ch__metrics__t_html_a39c926a02488425369c35c514a5aff92"><div class="ttname"><a href="structsrsue_1_1ch__metrics__t.html#a39c926a02488425369c35c514a5aff92">srsue::ch_metrics_t::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdef"><b>Definition:</b> phy_metrics.h:103</div></div>
<div class="ttc" id="astructsrsran__harq__ack__m__t_html"><div class="ttname"><a href="structsrsran__harq__ack__m__t.html">srsran_harq_ack_m_t</a></div><div class="ttdoc">Describes a single PDSCH transmission HARQ ACK feedback.</div><div class="ttdef"><b>Definition:</b> harq_ack_cfg.h:51</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a9dfe21caecd546922afb7435f6155e69"><div class="ttname"><a href="structSRSRAN__API.html#a9dfe21caecd546922afb7435f6155e69">SRSRAN_API::pid</a></div><div class="ttdeci">uint32_t pid</div><div class="ttdoc">HARQ process number.</div><div class="ttdef"><b>Definition:</b> dci.h:117</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a77f048297b136affc11f60b3b5174ced"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a77f048297b136affc11f60b3b5174ced">srsue::nr::state::dl_ul_semaphore</a></div><div class="ttdeci">srsran::tti_semaphore&lt; void * &gt; dl_ul_semaphore</div><div class="ttdoc">Semaphore for aligning UL work.</div><div class="ttdef"><b>Definition:</b> state.h:97</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a0b5da7f4f30a0a3c1d802303b0a0e4f6"><div class="ttname"><a href="structSRSRAN__API.html#a0b5da7f4f30a0a3c1d802303b0a0e4f6">SRSRAN_API::cfg</a></div><div class="ttdeci">srsran_cfr_cfg_t cfg</div><div class="ttdef"><b>Definition:</b> cfr.h:64</div></div>
<div class="ttc" id="acommon_2common_8h_html_a54bfee4588ec6db455ac4ed8aeca95e3"><div class="ttname"><a href="common_2common_8h.html#a54bfee4588ec6db455ac4ed8aeca95e3">TTI_ADD</a></div><div class="ttdeci">#define TTI_ADD(a, b)</div><div class="ttdef"><b>Definition:</b> common.h:53</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_abcb27ff27d3b6d94e980e95006faea6b"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#abcb27ff27d3b6d94e980e95006faea6b">srsue::nr::state::set_info_metrics</a></div><div class="ttdeci">void set_info_metrics(const info_metrics_t &amp;m)</div><div class="ttdoc">Sets time and frequency synchronization metrics.</div><div class="ttdef"><b>Definition:</b> state.h:397</div></div>
<div class="ttc" id="acommon_2common_8h_html"><div class="ttname"><a href="common_2common_8h.html">common.h</a></div></div>
<div class="ttc" id="astructsrsue_1_1ch__metrics__t_html_a069aaeebd1b321d5905cb7ec9b08fa2f"><div class="ttname"><a href="structsrsue_1_1ch__metrics__t.html#a069aaeebd1b321d5905cb7ec9b08fa2f">srsue::ch_metrics_t::rssi</a></div><div class="ttdeci">float rssi</div><div class="ttdef"><b>Definition:</b> phy_metrics.h:82</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a3e75521102a6ea3bfdb796a401f26ebd"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a3e75521102a6ea3bfdb796a401f26ebd">srsue::nr::state::pending_dl_grant</a></div><div class="ttdeci">srsran::circular_array&lt; pending_dl_grant_t, TTIMOD_SZ &gt; pending_dl_grant</div><div class="ttdef"><b>Definition:</b> state.h:54</div></div>
<div class="ttc" id="astructsrsran__harq__ack__m__t_html_ae7855cf652200139a7008bd2bc3acf8a"><div class="ttname"><a href="structsrsran__harq__ack__m__t.html#ae7855cf652200139a7008bd2bc3acf8a">srsran_harq_ack_m_t::resource</a></div><div class="ttdeci">srsran_harq_ack_resource_t resource</div><div class="ttdef"><b>Definition:</b> harq_ack_cfg.h:52</div></div>
<div class="ttc" id="aharq__ack_8h_html_a7f25ddaef651b82eb8b79f5652e24c9d"><div class="ttname"><a href="harq__ack_8h.html#a7f25ddaef651b82eb8b79f5652e24c9d">srsran_harq_ack_insert_m</a></div><div class="ttdeci">SRSRAN_API int srsran_harq_ack_insert_m(srsran_pdsch_ack_nr_t *ack_info, const srsran_harq_ack_m_t *m)</div><div class="ttdef"><b>Definition:</b> harq_ack.c:290</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a43d8a173301138c9fd1ffe9f044d9f2b"><div class="ttname"><a href="structSRSRAN__API.html#a43d8a173301138c9fd1ffe9f044d9f2b">SRSRAN_API::nof_csi</a></div><div class="ttdeci">uint32_t nof_csi</div><div class="ttdoc">Number of CSI reports.</div><div class="ttdef"><b>Definition:</b> uci_cfg_nr.h:84</div></div>
<div class="ttc" id="astructsrsue_1_1phy__args__nr__t_html_ad3551078cdca656ec7b0942e7de5b659"><div class="ttname"><a href="structsrsue_1_1phy__args__nr__t.html#ad3551078cdca656ec7b0942e7de5b659">srsue::phy_args_nr_t::fix_wideband_cqi</a></div><div class="ttdeci">uint32_t fix_wideband_cqi</div><div class="ttdoc">Set to a non-zero value for fixing the wide-band CQI report.</div><div class="ttdef"><b>Definition:</b> ue_nr_interfaces.h:227</div></div>
<div class="ttc" id="astructSRSRAN__API_html_a848d8edae3778a25b675f2cc223ba3d2"><div class="ttname"><a href="structSRSRAN__API.html#a848d8edae3778a25b675f2cc223ba3d2">SRSRAN_API::wideband_rsrp_dBm</a></div><div class="ttdeci">float wideband_rsrp_dBm</div><div class="ttdoc">Measured NZP-CSI-RS RSRP (Ignore for IM-CSI-RS)</div><div class="ttdef"><b>Definition:</b> csi_cfg.h:168</div></div>
<div class="ttc" id="aclasssrsue_1_1nr_1_1state_html_a83c09ac445dd136d6049eb4d6989685a"><div class="ttname"><a href="classsrsue_1_1nr_1_1state.html#a83c09ac445dd136d6049eb4d6989685a">srsue::nr::state::pending_ack_mutex</a></div><div class="ttdeci">std::mutex pending_ack_mutex</div><div class="ttdef"><b>Definition:</b> state.h:58</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
