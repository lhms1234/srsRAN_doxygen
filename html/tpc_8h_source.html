<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>srsRAN: srsenb/hdr/stack/mac/sched_ue_ctrl/tpc.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">srsRAN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dca0c3bf807981c8717bb8ce405280d0.html">srsenb</a></li><li class="navelem"><a class="el" href="dir_0d117b62b7a0ef3f0dfb96ab62415c83.html">hdr</a></li><li class="navelem"><a class="el" href="dir_3516cb39c95202a20b4e4ec6da6fc970.html">stack</a></li><li class="navelem"><a class="el" href="dir_5ade65de46e25088db701f1241b360f8.html">mac</a></li><li class="navelem"><a class="el" href="dir_190ad84c5204ed314595802131032a2a.html">sched_ue_ctrl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">tpc.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="tpc_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#ifndef SRSRAN_TPC_H</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#define SRSRAN_TPC_H</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="accumulators_8h.html">srsran/adt/accumulators.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="common_2common_8h.html">srsran/common/common.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="srslog_8h.html">srsran/srslog/srslog.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacesrsenb.html">srsenb</a> {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html">   37</a></span>&#160;<span class="keyword">class </span><a class="code" href="classsrsenb_1_1tpc.html">tpc</a></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#abb2300aeaad2658b56974aa24ce2f549">   39</a></span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">int</span>      <a class="code" href="classsrsenb_1_1tpc.html#abb2300aeaad2658b56974aa24ce2f549">undefined_phr</a>  = <a class="code" href="namespacesrsran.html#a3527b31ab6e41ebdbad4a39199a2c3b4">std::numeric_limits&lt;int&gt;::max</a>();</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a30ac67c6e48942aa35e5501634536432">   40</a></span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">float</span>    <a class="code" href="classsrsenb_1_1tpc.html#a30ac67c6e48942aa35e5501634536432">null_snr</a>       = <a class="code" href="namespacesrsran.html#a3527b31ab6e41ebdbad4a39199a2c3b4">std::numeric_limits&lt;float&gt;::max</a>();</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a9fbe39a7cf0e44fc13f4c09e355d06d7">   41</a></span>&#160;  <span class="keyword">static</span> constexpr uint32_t <a class="code" href="classsrsenb_1_1tpc.html#a9fbe39a7cf0e44fc13f4c09e355d06d7">nof_ul_ch_code</a> = 2;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#abfaae6f934da5185e682d291354c8051">   44</a></span>&#160;  <span class="keyword">static</span> constexpr uint32_t <a class="code" href="classsrsenb_1_1tpc.html#abfaae6f934da5185e682d291354c8051">PUSCH_CODE</a> = 0, <a class="code" href="classsrsenb_1_1tpc.html#a9dd6cedc528f7222117db3787603b08c">PUCCH_CODE</a> = 1;</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#ab81799f82ad3644d3fed205bdc3f6c65">   45</a></span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">int</span>      <a class="code" href="classsrsenb_1_1tpc.html#ab81799f82ad3644d3fed205bdc3f6c65">PHR_NEG_NOF_PRB</a> = 1;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a16fb9a504c6ecd2c7dbda0105c85a188">   47</a></span>&#160;  <span class="keyword">explicit</span> <a class="code" href="classsrsenb_1_1tpc.html#a16fb9a504c6ecd2c7dbda0105c85a188">tpc</a>(uint16_t rnti_,</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;               uint32_t cell_nof_prb,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;               <span class="keywordtype">float</span>    target_pucch_snr_dB_  = -1.0,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;               <span class="keywordtype">float</span>    target_pusch_sn_dB_   = -1.0,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;               <span class="keywordtype">bool</span>     phr_handling_flag_    = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;               <span class="keywordtype">int</span>      min_phr_thres_        = 0,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;               uint32_t min_tpc_tti_interval_ = 1,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;               <span class="keywordtype">float</span>    ul_snr_avg_alpha      = 0.05,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;               <span class="keywordtype">int</span>      init_ul_snr_value     = 5) :</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classsrsenb_1_1tpc.html#ac956791bd6b4ea9043d7a282c0cf6ccd">rnti</a>(rnti_),</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="classsrsenb_1_1tpc.html#a397d4338230d9dcc1f20f5049d4260db">nof_prb</a>(cell_nof_prb),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="classsrsenb_1_1tpc.html#a5f1d0fb3c8a874896bda3b81510c6f74">target_pucch_snr_dB</a>(target_pucch_snr_dB_),</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="classsrsenb_1_1tpc.html#aad68f42bd4782ec092df75c38512e960">target_pusch_snr_dB</a>(target_pusch_sn_dB_),</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="classsrsenb_1_1tpc.html#a7153c800225ae806993aafa428b64c4c">min_phr_thres</a>(min_phr_thres_),</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="classsrsenb_1_1tpc.html#a3220c75841b4fb8deff9faac87c0df2a">snr_estim_list</a>(</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        {<a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html">ul_ch_snr_estim</a>{ul_snr_avg_alpha, init_ul_snr_value}, <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html">ul_ch_snr_estim</a>{ul_snr_avg_alpha, init_ul_snr_value}}),</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="classsrsenb_1_1tpc.html#aa7b77caf2fc87018ab073211fd48a3a7">phr_handling_flag</a>(phr_handling_flag_),</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="classsrsenb_1_1tpc.html#a6382f22d16432e44e74aeb3ca0f944e1">max_prbs_cached</a>(<a class="code" href="classsrsenb_1_1tpc.html#a397d4338230d9dcc1f20f5049d4260db">nof_prb</a>),</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="classsrsenb_1_1tpc.html#abd5cc66662318307a3e9c8d24c07ed2b">min_tpc_tti_interval</a>(min_tpc_tti_interval_),</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="classsrsenb_1_1tpc.html#a57e0926db117d02ad6f06e83f9cc97e2">logger</a>(<a class="code" href="namespacesrslog.html#a7c6cd017ea70905a8cb4486b7a7fdda6">srslog::fetch_basic_logger</a>(<span class="stringliteral">&quot;MAC&quot;</span>))</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  {}</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a5fe8e196b908dd27a1f6f0f30465a6dc">   68</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsenb_1_1tpc.html#a5fe8e196b908dd27a1f6f0f30465a6dc">set_cfg</a>(<span class="keywordtype">float</span> target_pusch_snr_dB_, <span class="keywordtype">float</span> target_pucch_snr_dB_)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="classsrsenb_1_1tpc.html#a5f1d0fb3c8a874896bda3b81510c6f74">target_pucch_snr_dB</a> = target_pucch_snr_dB_;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="classsrsenb_1_1tpc.html#aad68f42bd4782ec092df75c38512e960">target_pusch_snr_dB</a> = target_pusch_snr_dB_;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a691f386f7ade09d4012f2a9c5a10a1ee">   74</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsenb_1_1tpc.html#a691f386f7ade09d4012f2a9c5a10a1ee">set_snr</a>(<span class="keywordtype">float</span> snr, uint32_t ul_ch_code)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">float</span> MIN_UL_SNR = -4.0f;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="npdsch__npdcch__file__test_8c.html#a2f13c0d577ea505db647b3e3a8600831">snr</a> &lt; MIN_UL_SNR) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="comment">// Assume signal was not sent</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (ul_ch_code &lt; <a class="code" href="classsrsenb_1_1tpc.html#a9fbe39a7cf0e44fc13f4c09e355d06d7">nof_ul_ch_code</a>) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <a class="code" href="classsrsenb_1_1tpc.html#a3220c75841b4fb8deff9faac87c0df2a">snr_estim_list</a>[ul_ch_code].pending_snr = <a class="code" href="npdsch__npdcch__file__test_8c.html#a2f13c0d577ea505db647b3e3a8600831">snr</a>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  }</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a8e6be53066e76118c6e09aa954a0b73c">   85</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsenb_1_1tpc.html#a8e6be53066e76118c6e09aa954a0b73c">set_phr</a>(<span class="keywordtype">int</span> phr_, uint32_t grant_nof_prbs)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classsrsenb_1_1tpc.html#a12fd4438041ede17a8409aa4f22fa1de">last_phr</a> = phr_;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ch_snr : <a class="code" href="classsrsenb_1_1tpc.html#a3220c75841b4fb8deff9faac87c0df2a">snr_estim_list</a>) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      ch_snr.acc_tpc_phr_values = 0;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// compute and cache the max nof UL PRBs that avoids overflowing PHR</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classsrsenb_1_1tpc.html#aa7b77caf2fc87018ab073211fd48a3a7">phr_handling_flag</a>) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <a class="code" href="classsrsenb_1_1tpc.html#a6382f22d16432e44e74aeb3ca0f944e1">max_prbs_cached</a> = <a class="code" href="classsrsenb_1_1tpc.html#ab81799f82ad3644d3fed205bdc3f6c65">PHR_NEG_NOF_PRB</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordtype">int</span> phr_x_prb   = std::roundf(<a class="code" href="classsrsenb_1_1tpc.html#a12fd4438041ede17a8409aa4f22fa1de">last_phr</a> + 10.0<a class="code" href="zuc_8cc.html#aaaf62f51dde26b6106af113cfc77b8cd">F</a> * log10f(grant_nof_prbs)); <span class="comment">// get what the PHR would be if Nprb=1</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = <a class="code" href="classsrsenb_1_1tpc.html#a397d4338230d9dcc1f20f5049d4260db">nof_prb</a>; n &gt; <a class="code" href="classsrsenb_1_1tpc.html#ab81799f82ad3644d3fed205bdc3f6c65">PHR_NEG_NOF_PRB</a>; --n) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">if</span> (phr_x_prb &gt;= 10 * log10f(n) + <a class="code" href="classsrsenb_1_1tpc.html#a7153c800225ae806993aafa428b64c4c">min_phr_thres</a>) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          <a class="code" href="classsrsenb_1_1tpc.html#a6382f22d16432e44e74aeb3ca0f944e1">max_prbs_cached</a> = n;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <a class="code" href="classsrsenb_1_1tpc.html#a57e0926db117d02ad6f06e83f9cc97e2">logger</a>.info(<span class="stringliteral">&quot;SCHED: rnti=0x%x received PHR=%d for UL Nprb=%d. Max UL Nprb is now=%d&quot;</span>,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                  <a class="code" href="classsrsenb_1_1tpc.html#ac956791bd6b4ea9043d7a282c0cf6ccd">rnti</a>,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                  phr_,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                  grant_nof_prbs,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                  <a class="code" href="classsrsenb_1_1tpc.html#a6382f22d16432e44e74aeb3ca0f944e1">max_prbs_cached</a>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#aae2937da7339d447a1f699c41c9859de">  110</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classsrsenb_1_1tpc.html#aae2937da7339d447a1f699c41c9859de">new_tti</a>()</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="classsrsenb_1_1tpc.html#affa3591d07eb0df7f3658dd66ab8a88e">tti_count</a>++;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> chidx = 0; chidx &lt; <a class="code" href="classsrsenb_1_1tpc.html#a9fbe39a7cf0e44fc13f4c09e355d06d7">nof_ul_ch_code</a>; ++chidx) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordtype">float</span> target_snr_dB = chidx == <a class="code" href="classsrsenb_1_1tpc.html#abfaae6f934da5185e682d291354c8051">PUSCH_CODE</a> ? <a class="code" href="classsrsenb_1_1tpc.html#aad68f42bd4782ec092df75c38512e960">target_pusch_snr_dB</a> : <a class="code" href="classsrsenb_1_1tpc.html#a5f1d0fb3c8a874896bda3b81510c6f74">target_pucch_snr_dB</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keyword">auto</span>&amp; ch_snr        = <a class="code" href="classsrsenb_1_1tpc.html#a3220c75841b4fb8deff9faac87c0df2a">snr_estim_list</a>[chidx];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="comment">// Enqueue pending UL Channel SNR measurement</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">if</span> (ch_snr.pending_snr == <a class="code" href="classsrsenb_1_1tpc.html#a30ac67c6e48942aa35e5501634536432">null_snr</a>) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        ch_snr.last_snr_sample_count++;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        ch_snr.acc_tpc_values += ch_snr.win_tpc_values.oldest();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        ch_snr.acc_tpc_phr_values += ch_snr.win_tpc_values.oldest();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        ch_snr.acc_tpc_values = 0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        ch_snr.snr_avg.push(ch_snr.pending_snr, ch_snr.last_snr_sample_count);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        ch_snr.last_snr_sample       = ch_snr.pending_snr;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        ch_snr.last_snr_sample_count = 1;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      ch_snr.pending_snr = <a class="code" href="classsrsenb_1_1tpc.html#a30ac67c6e48942aa35e5501634536432">null_snr</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="comment">// Enqueue PUSCH/PUCCH TPC sent in last TTI (zero for both Delta_PUSCH/Delta_PUCCH=0 and TPC not sent)</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordflow">if</span> (target_snr_dB &gt;= 0) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        ch_snr.win_tpc_values.push(ch_snr.pending_delta);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      ch_snr.pending_delta = 0;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a1486ba916b807ba80b2b1923897a4a29">  143</a></span>&#160;  uint8_t <a class="code" href="classsrsenb_1_1tpc.html#a1486ba916b807ba80b2b1923897a4a29">encode_pusch_tpc</a>() { <span class="keywordflow">return</span> <a class="code" href="classsrsenb_1_1tpc.html#adb94f3dc4dd3d43cfc3e91af517ddaaa">encode_tpc</a>(<a class="code" href="classsrsenb_1_1tpc.html#abfaae6f934da5185e682d291354c8051">PUSCH_CODE</a>); }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a49b12c0c7380f60510da86ac7edaebc8">  150</a></span>&#160;  uint8_t <a class="code" href="classsrsenb_1_1tpc.html#a49b12c0c7380f60510da86ac7edaebc8">encode_pucch_tpc</a>() { <span class="keywordflow">return</span> <a class="code" href="classsrsenb_1_1tpc.html#adb94f3dc4dd3d43cfc3e91af517ddaaa">encode_tpc</a>(<a class="code" href="classsrsenb_1_1tpc.html#a9dd6cedc528f7222117db3787603b08c">PUCCH_CODE</a>); }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a40912df02881ab1b3e37d3c4271aabbd">  152</a></span>&#160;  uint32_t <a class="code" href="classsrsenb_1_1tpc.html#a40912df02881ab1b3e37d3c4271aabbd">max_ul_prbs</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classsrsenb_1_1tpc.html#a6382f22d16432e44e74aeb3ca0f944e1">max_prbs_cached</a>; }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#ab0a7f2ba4771b9f24bac4c0151b78319">  154</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="classsrsenb_1_1tpc.html#ab0a7f2ba4771b9f24bac4c0151b78319">get_ul_snr_estim</a>(uint32_t ul_ch_code = <a class="code" href="classsrsenb_1_1tpc.html#abfaae6f934da5185e682d291354c8051">PUSCH_CODE</a>)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classsrsenb_1_1tpc.html#a3220c75841b4fb8deff9faac87c0df2a">snr_estim_list</a>[ul_ch_code].snr_avg.value(); }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a58f2caec051e98e3004c158279523327">  157</a></span>&#160;  uint8_t <a class="code" href="classsrsenb_1_1tpc.html#a58f2caec051e98e3004c158279523327">encode_tpc_delta</a>(int8_t delta)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">switch</span> (delta) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordflow">case</span> -1:</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">return</span> 3;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <a class="code" href="classsrsenb_1_1tpc.html#a57e0926db117d02ad6f06e83f9cc97e2">logger</a>.warning(<span class="stringliteral">&quot;Invalid TPC delta value=%d&quot;</span>, delta);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#adb94f3dc4dd3d43cfc3e91af517ddaaa">  173</a></span>&#160;  uint8_t <a class="code" href="classsrsenb_1_1tpc.html#adb94f3dc4dd3d43cfc3e91af517ddaaa">encode_tpc</a>(uint32_t cc)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keyword">auto</span>&amp; ch_snr = <a class="code" href="classsrsenb_1_1tpc.html#a3220c75841b4fb8deff9faac87c0df2a">snr_estim_list</a>[cc];</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    assert(ch_snr.pending_delta == 0); <span class="comment">// ensure called once per {cc,tti}</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordtype">float</span> target_snr_dB = cc == <a class="code" href="classsrsenb_1_1tpc.html#abfaae6f934da5185e682d291354c8051">PUSCH_CODE</a> ? <a class="code" href="classsrsenb_1_1tpc.html#aad68f42bd4782ec092df75c38512e960">target_pusch_snr_dB</a> : <a class="code" href="classsrsenb_1_1tpc.html#a5f1d0fb3c8a874896bda3b81510c6f74">target_pucch_snr_dB</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span> (target_snr_dB &lt; 0) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="comment">// undefined target SINR case</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classsrsenb_1_1tpc.html#a58f2caec051e98e3004c158279523327">encode_tpc_delta</a>(0);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// limitation of TPC based on PHR</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordtype">int</span> max_delta = 3;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">int</span> eff_phr   = <a class="code" href="classsrsenb_1_1tpc.html#a12fd4438041ede17a8409aa4f22fa1de">last_phr</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (cc == <a class="code" href="classsrsenb_1_1tpc.html#abfaae6f934da5185e682d291354c8051">PUSCH_CODE</a> and <a class="code" href="classsrsenb_1_1tpc.html#a12fd4438041ede17a8409aa4f22fa1de">last_phr</a> != <a class="code" href="classsrsenb_1_1tpc.html#abb2300aeaad2658b56974aa24ce2f549">undefined_phr</a>) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      eff_phr -= ch_snr.win_tpc_values.value() + ch_snr.acc_tpc_phr_values;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      max_delta = <a class="code" href="ra__dl_8c.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(max_delta, eff_phr);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="npdsch__npdcch__file__test_8c.html#a2f13c0d577ea505db647b3e3a8600831">snr</a> = ch_snr.last_snr_sample;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// In case of periodicity of TPCs is &gt; 1 tti, use average SNR to compute SNR diff</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classsrsenb_1_1tpc.html#abd5cc66662318307a3e9c8d24c07ed2b">min_tpc_tti_interval</a> &gt; 1) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      ch_snr.tpc_snr_avg.push(<a class="code" href="npdsch__npdcch__file__test_8c.html#a2f13c0d577ea505db647b3e3a8600831">snr</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="classsrsenb_1_1tpc.html#affa3591d07eb0df7f3658dd66ab8a88e">tti_count</a> - ch_snr.last_tpc_tti_count) &lt; <a class="code" href="classsrsenb_1_1tpc.html#abd5cc66662318307a3e9c8d24c07ed2b">min_tpc_tti_interval</a>) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="comment">// more time required before sending next TPC</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classsrsenb_1_1tpc.html#a58f2caec051e98e3004c158279523327">encode_tpc_delta</a>(0);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <a class="code" href="npdsch__npdcch__file__test_8c.html#a2f13c0d577ea505db647b3e3a8600831">snr</a> = ch_snr.tpc_snr_avg.value();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordtype">float</span> diff = target_snr_dB - <a class="code" href="npdsch__npdcch__file__test_8c.html#a2f13c0d577ea505db647b3e3a8600831">snr</a>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    diff -= ch_snr.win_tpc_values.value() + ch_snr.acc_tpc_values;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    ch_snr.pending_delta = <a class="code" href="namespacesrsran.html#a3527b31ab6e41ebdbad4a39199a2c3b4">std::max</a>(<a class="code" href="ra__dl_8c.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>((<span class="keywordtype">int</span>)floorf(diff), max_delta), -1);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    ch_snr.pending_delta = (ch_snr.pending_delta == 2) ? 1 : ch_snr.pending_delta;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="CMakeLists_8txt.html#a0508d28f02406eef8791f2f6fb504c75">if</a> (ch_snr.pending_delta != 0) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classsrsenb_1_1tpc.html#abd5cc66662318307a3e9c8d24c07ed2b">min_tpc_tti_interval</a> &gt; 1) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        ch_snr.last_tpc_tti_count = <a class="code" href="classsrsenb_1_1tpc.html#affa3591d07eb0df7f3658dd66ab8a88e">tti_count</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        ch_snr.tpc_snr_avg.reset();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <a class="code" href="classsrsenb_1_1tpc.html#a57e0926db117d02ad6f06e83f9cc97e2">logger</a>.debug(<span class="stringliteral">&quot;TPC: rnti=0x%x, %s command=%d, last SNR=%d, SNR average=%f, diff_acc=%f, eff_phr=%d&quot;</span>,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                   <a class="code" href="classsrsenb_1_1tpc.html#ac956791bd6b4ea9043d7a282c0cf6ccd">rnti</a>,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                   cc == <a class="code" href="classsrsenb_1_1tpc.html#abfaae6f934da5185e682d291354c8051">PUSCH_CODE</a> ? <span class="stringliteral">&quot;PUSCH&quot;</span> : <span class="stringliteral">&quot;PUCCH&quot;</span>,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                   <a class="code" href="classsrsenb_1_1tpc.html#a58f2caec051e98e3004c158279523327">encode_tpc_delta</a>(ch_snr.pending_delta),</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                   ch_snr.last_snr_sample,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                   ch_snr.snr_avg.value(),</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                   diff,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                   eff_phr);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classsrsenb_1_1tpc.html#a58f2caec051e98e3004c158279523327">encode_tpc_delta</a>(ch_snr.pending_delta);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#ac956791bd6b4ea9043d7a282c0cf6ccd">  224</a></span>&#160;  uint16_t              <a class="code" href="classsrsenb_1_1tpc.html#ac956791bd6b4ea9043d7a282c0cf6ccd">rnti</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a397d4338230d9dcc1f20f5049d4260db">  225</a></span>&#160;  uint32_t              <a class="code" href="classsrsenb_1_1tpc.html#a397d4338230d9dcc1f20f5049d4260db">nof_prb</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#abd5cc66662318307a3e9c8d24c07ed2b">  226</a></span>&#160;  uint32_t              <a class="code" href="classsrsenb_1_1tpc.html#abd5cc66662318307a3e9c8d24c07ed2b">min_tpc_tti_interval</a> = 1;</div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#aad68f42bd4782ec092df75c38512e960">  227</a></span>&#160;  <span class="keywordtype">float</span>                 <a class="code" href="classsrsenb_1_1tpc.html#a5f1d0fb3c8a874896bda3b81510c6f74">target_pucch_snr_dB</a>, <a class="code" href="classsrsenb_1_1tpc.html#aad68f42bd4782ec092df75c38512e960">target_pusch_snr_dB</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a7153c800225ae806993aafa428b64c4c">  228</a></span>&#160;  <span class="keywordtype">int</span>                   <a class="code" href="classsrsenb_1_1tpc.html#a7153c800225ae806993aafa428b64c4c">min_phr_thres</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#aa7b77caf2fc87018ab073211fd48a3a7">  229</a></span>&#160;  <span class="keywordtype">bool</span>                  <a class="code" href="classsrsenb_1_1tpc.html#aa7b77caf2fc87018ab073211fd48a3a7">phr_handling_flag</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a57e0926db117d02ad6f06e83f9cc97e2">  230</a></span>&#160;  <a class="code" href="classsrslog_1_1detail_1_1logger__impl.html">srslog::basic_logger</a>&amp; <a class="code" href="classsrsenb_1_1tpc.html#a57e0926db117d02ad6f06e83f9cc97e2">logger</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">// state</span></div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#affa3591d07eb0df7f3658dd66ab8a88e">  233</a></span>&#160;  uint32_t <a class="code" href="classsrsenb_1_1tpc.html#affa3591d07eb0df7f3658dd66ab8a88e">tti_count</a> = 0;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">// PHR-related variables</span></div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a12fd4438041ede17a8409aa4f22fa1de">  236</a></span>&#160;  <span class="keywordtype">int</span>      <a class="code" href="classsrsenb_1_1tpc.html#a12fd4438041ede17a8409aa4f22fa1de">last_phr</a>        = <a class="code" href="classsrsenb_1_1tpc.html#abb2300aeaad2658b56974aa24ce2f549">undefined_phr</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a6382f22d16432e44e74aeb3ca0f944e1">  237</a></span>&#160;  uint32_t <a class="code" href="classsrsenb_1_1tpc.html#a6382f22d16432e44e74aeb3ca0f944e1">max_prbs_cached</a> = 100;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// SNR estimation</span></div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html">  240</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html">ul_ch_snr_estim</a> {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// pending new snr sample</span></div>
<div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#af3b12ee8424cdac8fe9bfcd48a9f00b1">  242</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#af3b12ee8424cdac8fe9bfcd48a9f00b1">pending_snr</a> = <a class="code" href="structsrsran_1_1null__sliding__average.html#aeb5cae9ae9fd1ceba5fdbcf689f5d2f1">srsran::null_sliding_average&lt;float&gt;::null_value</a>();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// SNR average estimation with irregular sample spacing</span></div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a9653ca44cb7ec216a5861536b6296cdf">  244</a></span>&#160;    uint32_t                                  <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a9653ca44cb7ec216a5861536b6296cdf">last_snr_sample_count</a> = 1; <span class="comment">// jump in spacing</span></div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a7a8b8e36dbaaa07b6980539fd2feac77">  245</a></span>&#160;    <a class="code" href="structsrsran_1_1exp__average__irreg__sampling.html">srsran::exp_average_irreg_sampling&lt;float&gt;</a> <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a7a8b8e36dbaaa07b6980539fd2feac77">snr_avg</a>;</div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#ae3c3c19ca6d35e948c8d8bda7c25613c">  246</a></span>&#160;    <span class="keywordtype">int</span>                                       <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#ae3c3c19ca6d35e948c8d8bda7c25613c">last_snr_sample</a>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// Accumulation of past TPC commands</span></div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#ae1ce398b4d060fc3e66b3c70425b42b2">  248</a></span>&#160;    <a class="code" href="structsrsran_1_1sliding__sum.html">srsran::sliding_sum&lt;int&gt;</a>       <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#ae1ce398b4d060fc3e66b3c70425b42b2">win_tpc_values</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a91c746ecac559a3c8b8ef48c15d24d73">  249</a></span>&#160;    <span class="keywordtype">int</span>                            <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a91c746ecac559a3c8b8ef48c15d24d73">acc_tpc_values</a>     = 0;</div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a056ee004bfc093026122943aaf39c673">  250</a></span>&#160;    <span class="keywordtype">int</span>                            <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a056ee004bfc093026122943aaf39c673">acc_tpc_phr_values</a> = 0;</div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a041d90feb144b702bb46214d7a82b3e3">  251</a></span>&#160;    int8_t                         <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a041d90feb144b702bb46214d7a82b3e3">pending_delta</a>      = 0;</div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a88e15f9578e6bd0ca4d91fb5a2728371">  252</a></span>&#160;    uint32_t                       <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a88e15f9578e6bd0ca4d91fb5a2728371">last_tpc_tti_count</a> = 0;</div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a0fb0498216d93d4c933c4edd1302af28">  253</a></span>&#160;    <a class="code" href="structsrsran_1_1rolling__average.html">srsran::rolling_average&lt;float&gt;</a> <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a0fb0498216d93d4c933c4edd1302af28">tpc_snr_avg</a>; <span class="comment">// average of SNRs since last TPC != 1</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a37d142fd46e38d4a2eb7e11722bca3ba">  255</a></span>&#160;    <span class="keyword">explicit</span> <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a37d142fd46e38d4a2eb7e11722bca3ba">ul_ch_snr_estim</a>(<span class="keywordtype">float</span> exp_avg_alpha, <span class="keywordtype">int</span> initial_snr) :</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a7a8b8e36dbaaa07b6980539fd2feac77">snr_avg</a>(exp_avg_alpha, initial_snr),</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#ae1ce398b4d060fc3e66b3c70425b42b2">win_tpc_values</a>(<a class="code" href="common_2common_8h.html#a2293fef0f1c9553731d221d7bc8c7a94">FDD_HARQ_DELAY_UL_MS</a> + <a class="code" href="common_2common_8h.html#a2a1ff3b74ecbb4f4ffd7fed5e0c96aad">FDD_HARQ_DELAY_DL_MS</a>),</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <a class="code" href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#ae3c3c19ca6d35e948c8d8bda7c25613c">last_snr_sample</a>(initial_snr)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    {}</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  };</div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="classsrsenb_1_1tpc.html#a3220c75841b4fb8deff9faac87c0df2a">  261</a></span>&#160;  std::array&lt;ul_ch_snr_estim, nof_ul_ch_code&gt; <a class="code" href="classsrsenb_1_1tpc.html#a3220c75841b4fb8deff9faac87c0df2a">snr_estim_list</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;};</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;} <span class="comment">// namespace srsenb</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="preprocessor">#endif // SRSRAN_TPC_H</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclasssrsenb_1_1tpc_html_ab81799f82ad3644d3fed205bdc3f6c65"><div class="ttname"><a href="classsrsenb_1_1tpc.html#ab81799f82ad3644d3fed205bdc3f6c65">srsenb::tpc::PHR_NEG_NOF_PRB</a></div><div class="ttdeci">static constexpr int PHR_NEG_NOF_PRB</div><div class="ttdef"><b>Definition:</b> tpc.h:45</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_ac956791bd6b4ea9043d7a282c0cf6ccd"><div class="ttname"><a href="classsrsenb_1_1tpc.html#ac956791bd6b4ea9043d7a282c0cf6ccd">srsenb::tpc::rnti</a></div><div class="ttdeci">uint16_t rnti</div><div class="ttdef"><b>Definition:</b> tpc.h:224</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html"><div class="ttname"><a href="classsrsenb_1_1tpc.html">srsenb::tpc</a></div><div class="ttdef"><b>Definition:</b> tpc.h:37</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a57e0926db117d02ad6f06e83f9cc97e2"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a57e0926db117d02ad6f06e83f9cc97e2">srsenb::tpc::logger</a></div><div class="ttdeci">srslog::basic_logger &amp; logger</div><div class="ttdef"><b>Definition:</b> tpc.h:230</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_affa3591d07eb0df7f3658dd66ab8a88e"><div class="ttname"><a href="classsrsenb_1_1tpc.html#affa3591d07eb0df7f3658dd66ab8a88e">srsenb::tpc::tti_count</a></div><div class="ttdeci">uint32_t tti_count</div><div class="ttdef"><b>Definition:</b> tpc.h:233</div></div>
<div class="ttc" id="astructsrsran_1_1rolling__average_html"><div class="ttname"><a href="structsrsran_1_1rolling__average.html">srsran::rolling_average&lt; float &gt;</a></div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a8e6be53066e76118c6e09aa954a0b73c"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a8e6be53066e76118c6e09aa954a0b73c">srsenb::tpc::set_phr</a></div><div class="ttdeci">void set_phr(int phr_, uint32_t grant_nof_prbs)</div><div class="ttdef"><b>Definition:</b> tpc.h:85</div></div>
<div class="ttc" id="astructsrsenb_1_1tpc_1_1ul__ch__snr__estim_html_af3b12ee8424cdac8fe9bfcd48a9f00b1"><div class="ttname"><a href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#af3b12ee8424cdac8fe9bfcd48a9f00b1">srsenb::tpc::ul_ch_snr_estim::pending_snr</a></div><div class="ttdeci">float pending_snr</div><div class="ttdef"><b>Definition:</b> tpc.h:242</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a3220c75841b4fb8deff9faac87c0df2a"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a3220c75841b4fb8deff9faac87c0df2a">srsenb::tpc::snr_estim_list</a></div><div class="ttdeci">std::array&lt; ul_ch_snr_estim, nof_ul_ch_code &gt; snr_estim_list</div><div class="ttdef"><b>Definition:</b> tpc.h:261</div></div>
<div class="ttc" id="ara__dl_8c_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="ra__dl_8c.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> ra_dl.c:35</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a49b12c0c7380f60510da86ac7edaebc8"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a49b12c0c7380f60510da86ac7edaebc8">srsenb::tpc::encode_pucch_tpc</a></div><div class="ttdeci">uint8_t encode_pucch_tpc()</div><div class="ttdef"><b>Definition:</b> tpc.h:150</div></div>
<div class="ttc" id="aCMakeLists_8txt_html_a0508d28f02406eef8791f2f6fb504c75"><div class="ttname"><a href="CMakeLists_8txt.html#a0508d28f02406eef8791f2f6fb504c75">if</a></div><div class="ttdeci">if(${CMAKE_SOURCE_DIR} STREQUAL ${CMAKE_BINARY_DIR}) message(FATAL_ERROR &quot;Prevented in-tree build. This is bad practice.&quot;) endif($</div><div class="ttdef"><b>Definition:</b> CMakeLists.txt:25</div></div>
<div class="ttc" id="astructsrsenb_1_1tpc_1_1ul__ch__snr__estim_html_a056ee004bfc093026122943aaf39c673"><div class="ttname"><a href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a056ee004bfc093026122943aaf39c673">srsenb::tpc::ul_ch_snr_estim::acc_tpc_phr_values</a></div><div class="ttdeci">int acc_tpc_phr_values</div><div class="ttdef"><b>Definition:</b> tpc.h:250</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a691f386f7ade09d4012f2a9c5a10a1ee"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a691f386f7ade09d4012f2a9c5a10a1ee">srsenb::tpc::set_snr</a></div><div class="ttdeci">void set_snr(float snr, uint32_t ul_ch_code)</div><div class="ttdef"><b>Definition:</b> tpc.h:74</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a16fb9a504c6ecd2c7dbda0105c85a188"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a16fb9a504c6ecd2c7dbda0105c85a188">srsenb::tpc::tpc</a></div><div class="ttdeci">tpc(uint16_t rnti_, uint32_t cell_nof_prb, float target_pucch_snr_dB_=-1.0, float target_pusch_sn_dB_=-1.0, bool phr_handling_flag_=false, int min_phr_thres_=0, uint32_t min_tpc_tti_interval_=1, float ul_snr_avg_alpha=0.05, int init_ul_snr_value=5)</div><div class="ttdef"><b>Definition:</b> tpc.h:47</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a1486ba916b807ba80b2b1923897a4a29"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a1486ba916b807ba80b2b1923897a4a29">srsenb::tpc::encode_pusch_tpc</a></div><div class="ttdeci">uint8_t encode_pusch_tpc()</div><div class="ttdef"><b>Definition:</b> tpc.h:143</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a7153c800225ae806993aafa428b64c4c"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a7153c800225ae806993aafa428b64c4c">srsenb::tpc::min_phr_thres</a></div><div class="ttdeci">int min_phr_thres</div><div class="ttdef"><b>Definition:</b> tpc.h:228</div></div>
<div class="ttc" id="astructsrsenb_1_1tpc_1_1ul__ch__snr__estim_html_ae3c3c19ca6d35e948c8d8bda7c25613c"><div class="ttname"><a href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#ae3c3c19ca6d35e948c8d8bda7c25613c">srsenb::tpc::ul_ch_snr_estim::last_snr_sample</a></div><div class="ttdeci">int last_snr_sample</div><div class="ttdef"><b>Definition:</b> tpc.h:246</div></div>
<div class="ttc" id="astructsrsran_1_1sliding__sum_html"><div class="ttname"><a href="structsrsran_1_1sliding__sum.html">srsran::sliding_sum&lt; int &gt;</a></div></div>
<div class="ttc" id="astructsrsenb_1_1tpc_1_1ul__ch__snr__estim_html_a7a8b8e36dbaaa07b6980539fd2feac77"><div class="ttname"><a href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a7a8b8e36dbaaa07b6980539fd2feac77">srsenb::tpc::ul_ch_snr_estim::snr_avg</a></div><div class="ttdeci">srsran::exp_average_irreg_sampling&lt; float &gt; snr_avg</div><div class="ttdef"><b>Definition:</b> tpc.h:245</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a397d4338230d9dcc1f20f5049d4260db"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a397d4338230d9dcc1f20f5049d4260db">srsenb::tpc::nof_prb</a></div><div class="ttdeci">uint32_t nof_prb</div><div class="ttdef"><b>Definition:</b> tpc.h:225</div></div>
<div class="ttc" id="acommon_2common_8h_html_a2293fef0f1c9553731d221d7bc8c7a94"><div class="ttname"><a href="common_2common_8h.html#a2293fef0f1c9553731d221d7bc8c7a94">FDD_HARQ_DELAY_UL_MS</a></div><div class="ttdeci">#define FDD_HARQ_DELAY_UL_MS</div><div class="ttdef"><b>Definition:</b> common.h:49</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_abd5cc66662318307a3e9c8d24c07ed2b"><div class="ttname"><a href="classsrsenb_1_1tpc.html#abd5cc66662318307a3e9c8d24c07ed2b">srsenb::tpc::min_tpc_tti_interval</a></div><div class="ttdeci">uint32_t min_tpc_tti_interval</div><div class="ttdef"><b>Definition:</b> tpc.h:226</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a58f2caec051e98e3004c158279523327"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a58f2caec051e98e3004c158279523327">srsenb::tpc::encode_tpc_delta</a></div><div class="ttdeci">uint8_t encode_tpc_delta(int8_t delta)</div><div class="ttdef"><b>Definition:</b> tpc.h:157</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a6382f22d16432e44e74aeb3ca0f944e1"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a6382f22d16432e44e74aeb3ca0f944e1">srsenb::tpc::max_prbs_cached</a></div><div class="ttdeci">uint32_t max_prbs_cached</div><div class="ttdef"><b>Definition:</b> tpc.h:237</div></div>
<div class="ttc" id="astructsrsenb_1_1tpc_1_1ul__ch__snr__estim_html_ae1ce398b4d060fc3e66b3c70425b42b2"><div class="ttname"><a href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#ae1ce398b4d060fc3e66b3c70425b42b2">srsenb::tpc::ul_ch_snr_estim::win_tpc_values</a></div><div class="ttdeci">srsran::sliding_sum&lt; int &gt; win_tpc_values</div><div class="ttdef"><b>Definition:</b> tpc.h:248</div></div>
<div class="ttc" id="anpdsch__npdcch__file__test_8c_html_a2f13c0d577ea505db647b3e3a8600831"><div class="ttname"><a href="npdsch__npdcch__file__test_8c.html#a2f13c0d577ea505db647b3e3a8600831">snr</a></div><div class="ttdeci">float snr</div><div class="ttdef"><b>Definition:</b> npdsch_npdcch_file_test.c:55</div></div>
<div class="ttc" id="astructsrsran_1_1null__sliding__average_html_aeb5cae9ae9fd1ceba5fdbcf689f5d2f1"><div class="ttname"><a href="structsrsran_1_1null__sliding__average.html#aeb5cae9ae9fd1ceba5fdbcf689f5d2f1">srsran::null_sliding_average::null_value</a></div><div class="ttdeci">static constexpr T null_value()</div><div class="ttdef"><b>Definition:</b> accumulators.h:148</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a30ac67c6e48942aa35e5501634536432"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a30ac67c6e48942aa35e5501634536432">srsenb::tpc::null_snr</a></div><div class="ttdeci">static constexpr float null_snr</div><div class="ttdef"><b>Definition:</b> tpc.h:40</div></div>
<div class="ttc" id="anamespacesrslog_html_a7c6cd017ea70905a8cb4486b7a7fdda6"><div class="ttname"><a href="namespacesrslog.html#a7c6cd017ea70905a8cb4486b7a7fdda6">srslog::fetch_basic_logger</a></div><div class="ttdeci">basic_logger &amp; fetch_basic_logger(const std::string &amp;id, bool should_print_context=true)</div><div class="ttdef"><b>Definition:</b> srslog.cpp:315</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a9dd6cedc528f7222117db3787603b08c"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a9dd6cedc528f7222117db3787603b08c">srsenb::tpc::PUCCH_CODE</a></div><div class="ttdeci">static constexpr uint32_t PUCCH_CODE</div><div class="ttdef"><b>Definition:</b> tpc.h:44</div></div>
<div class="ttc" id="aaccumulators_8h_html"><div class="ttname"><a href="accumulators_8h.html">accumulators.h</a></div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a12fd4438041ede17a8409aa4f22fa1de"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a12fd4438041ede17a8409aa4f22fa1de">srsenb::tpc::last_phr</a></div><div class="ttdeci">int last_phr</div><div class="ttdef"><b>Definition:</b> tpc.h:236</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a5fe8e196b908dd27a1f6f0f30465a6dc"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a5fe8e196b908dd27a1f6f0f30465a6dc">srsenb::tpc::set_cfg</a></div><div class="ttdeci">void set_cfg(float target_pusch_snr_dB_, float target_pucch_snr_dB_)</div><div class="ttdef"><b>Definition:</b> tpc.h:68</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_ab0a7f2ba4771b9f24bac4c0151b78319"><div class="ttname"><a href="classsrsenb_1_1tpc.html#ab0a7f2ba4771b9f24bac4c0151b78319">srsenb::tpc::get_ul_snr_estim</a></div><div class="ttdeci">float get_ul_snr_estim(uint32_t ul_ch_code=PUSCH_CODE) const</div><div class="ttdef"><b>Definition:</b> tpc.h:154</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_abfaae6f934da5185e682d291354c8051"><div class="ttname"><a href="classsrsenb_1_1tpc.html#abfaae6f934da5185e682d291354c8051">srsenb::tpc::PUSCH_CODE</a></div><div class="ttdeci">static constexpr uint32_t PUSCH_CODE</div><div class="ttdef"><b>Definition:</b> tpc.h:44</div></div>
<div class="ttc" id="astructsrsenb_1_1tpc_1_1ul__ch__snr__estim_html_a91c746ecac559a3c8b8ef48c15d24d73"><div class="ttname"><a href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a91c746ecac559a3c8b8ef48c15d24d73">srsenb::tpc::ul_ch_snr_estim::acc_tpc_values</a></div><div class="ttdeci">int acc_tpc_values</div><div class="ttdef"><b>Definition:</b> tpc.h:249</div></div>
<div class="ttc" id="anamespacesrsran_html_a3527b31ab6e41ebdbad4a39199a2c3b4"><div class="ttname"><a href="namespacesrsran.html#a3527b31ab6e41ebdbad4a39199a2c3b4">srsran::max</a></div><div class="ttdeci">slot_point max(slot_point s1, slot_point s2)</div><div class="ttdef"><b>Definition:</b> slot_point.h:145</div></div>
<div class="ttc" id="asrslog_8h_html"><div class="ttname"><a href="srslog_8h.html">srslog.h</a></div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_aae2937da7339d447a1f699c41c9859de"><div class="ttname"><a href="classsrsenb_1_1tpc.html#aae2937da7339d447a1f699c41c9859de">srsenb::tpc::new_tti</a></div><div class="ttdeci">void new_tti()</div><div class="ttdef"><b>Definition:</b> tpc.h:110</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a9fbe39a7cf0e44fc13f4c09e355d06d7"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a9fbe39a7cf0e44fc13f4c09e355d06d7">srsenb::tpc::nof_ul_ch_code</a></div><div class="ttdeci">static constexpr uint32_t nof_ul_ch_code</div><div class="ttdef"><b>Definition:</b> tpc.h:41</div></div>
<div class="ttc" id="astructsrsenb_1_1tpc_1_1ul__ch__snr__estim_html"><div class="ttname"><a href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html">srsenb::tpc::ul_ch_snr_estim</a></div><div class="ttdef"><b>Definition:</b> tpc.h:240</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_aad68f42bd4782ec092df75c38512e960"><div class="ttname"><a href="classsrsenb_1_1tpc.html#aad68f42bd4782ec092df75c38512e960">srsenb::tpc::target_pusch_snr_dB</a></div><div class="ttdeci">float target_pusch_snr_dB</div><div class="ttdef"><b>Definition:</b> tpc.h:227</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_adb94f3dc4dd3d43cfc3e91af517ddaaa"><div class="ttname"><a href="classsrsenb_1_1tpc.html#adb94f3dc4dd3d43cfc3e91af517ddaaa">srsenb::tpc::encode_tpc</a></div><div class="ttdeci">uint8_t encode_tpc(uint32_t cc)</div><div class="ttdef"><b>Definition:</b> tpc.h:173</div></div>
<div class="ttc" id="astructsrsenb_1_1tpc_1_1ul__ch__snr__estim_html_a37d142fd46e38d4a2eb7e11722bca3ba"><div class="ttname"><a href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a37d142fd46e38d4a2eb7e11722bca3ba">srsenb::tpc::ul_ch_snr_estim::ul_ch_snr_estim</a></div><div class="ttdeci">ul_ch_snr_estim(float exp_avg_alpha, int initial_snr)</div><div class="ttdef"><b>Definition:</b> tpc.h:255</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a5f1d0fb3c8a874896bda3b81510c6f74"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a5f1d0fb3c8a874896bda3b81510c6f74">srsenb::tpc::target_pucch_snr_dB</a></div><div class="ttdeci">float target_pucch_snr_dB</div><div class="ttdef"><b>Definition:</b> tpc.h:227</div></div>
<div class="ttc" id="aclasssrslog_1_1detail_1_1logger__impl_html"><div class="ttname"><a href="classsrslog_1_1detail_1_1logger__impl.html">srslog::detail::logger_impl</a></div><div class="ttdef"><b>Definition:</b> logger.h:36</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_aa7b77caf2fc87018ab073211fd48a3a7"><div class="ttname"><a href="classsrsenb_1_1tpc.html#aa7b77caf2fc87018ab073211fd48a3a7">srsenb::tpc::phr_handling_flag</a></div><div class="ttdeci">bool phr_handling_flag</div><div class="ttdef"><b>Definition:</b> tpc.h:229</div></div>
<div class="ttc" id="astructsrsenb_1_1tpc_1_1ul__ch__snr__estim_html_a041d90feb144b702bb46214d7a82b3e3"><div class="ttname"><a href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a041d90feb144b702bb46214d7a82b3e3">srsenb::tpc::ul_ch_snr_estim::pending_delta</a></div><div class="ttdeci">int8_t pending_delta</div><div class="ttdef"><b>Definition:</b> tpc.h:251</div></div>
<div class="ttc" id="astructsrsenb_1_1tpc_1_1ul__ch__snr__estim_html_a9653ca44cb7ec216a5861536b6296cdf"><div class="ttname"><a href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a9653ca44cb7ec216a5861536b6296cdf">srsenb::tpc::ul_ch_snr_estim::last_snr_sample_count</a></div><div class="ttdeci">uint32_t last_snr_sample_count</div><div class="ttdef"><b>Definition:</b> tpc.h:244</div></div>
<div class="ttc" id="azuc_8cc_html_aaaf62f51dde26b6106af113cfc77b8cd"><div class="ttname"><a href="zuc_8cc.html#aaaf62f51dde26b6106af113cfc77b8cd">F</a></div><div class="ttdeci">u32 F(zuc_state_t *state)</div><div class="ttdef"><b>Definition:</b> zuc.cc:191</div></div>
<div class="ttc" id="astructsrsenb_1_1tpc_1_1ul__ch__snr__estim_html_a0fb0498216d93d4c933c4edd1302af28"><div class="ttname"><a href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a0fb0498216d93d4c933c4edd1302af28">srsenb::tpc::ul_ch_snr_estim::tpc_snr_avg</a></div><div class="ttdeci">srsran::rolling_average&lt; float &gt; tpc_snr_avg</div><div class="ttdef"><b>Definition:</b> tpc.h:253</div></div>
<div class="ttc" id="anamespacesrsenb_html"><div class="ttname"><a href="namespacesrsenb.html">srsenb</a></div><div class="ttdoc">Dummy X2AP implementation.</div><div class="ttdef"><b>Definition:</b> s1ap_utils.h:91</div></div>
<div class="ttc" id="acommon_2common_8h_html_a2a1ff3b74ecbb4f4ffd7fed5e0c96aad"><div class="ttname"><a href="common_2common_8h.html#a2a1ff3b74ecbb4f4ffd7fed5e0c96aad">FDD_HARQ_DELAY_DL_MS</a></div><div class="ttdeci">#define FDD_HARQ_DELAY_DL_MS</div><div class="ttdef"><b>Definition:</b> common.h:48</div></div>
<div class="ttc" id="acommon_2common_8h_html"><div class="ttname"><a href="common_2common_8h.html">common.h</a></div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_a40912df02881ab1b3e37d3c4271aabbd"><div class="ttname"><a href="classsrsenb_1_1tpc.html#a40912df02881ab1b3e37d3c4271aabbd">srsenb::tpc::max_ul_prbs</a></div><div class="ttdeci">uint32_t max_ul_prbs() const</div><div class="ttdef"><b>Definition:</b> tpc.h:152</div></div>
<div class="ttc" id="astructsrsenb_1_1tpc_1_1ul__ch__snr__estim_html_a88e15f9578e6bd0ca4d91fb5a2728371"><div class="ttname"><a href="structsrsenb_1_1tpc_1_1ul__ch__snr__estim.html#a88e15f9578e6bd0ca4d91fb5a2728371">srsenb::tpc::ul_ch_snr_estim::last_tpc_tti_count</a></div><div class="ttdeci">uint32_t last_tpc_tti_count</div><div class="ttdef"><b>Definition:</b> tpc.h:252</div></div>
<div class="ttc" id="aclasssrsenb_1_1tpc_html_abb2300aeaad2658b56974aa24ce2f549"><div class="ttname"><a href="classsrsenb_1_1tpc.html#abb2300aeaad2658b56974aa24ce2f549">srsenb::tpc::undefined_phr</a></div><div class="ttdeci">static constexpr int undefined_phr</div><div class="ttdef"><b>Definition:</b> tpc.h:39</div></div>
<div class="ttc" id="astructsrsran_1_1exp__average__irreg__sampling_html"><div class="ttname"><a href="structsrsran_1_1exp__average__irreg__sampling.html">srsran::exp_average_irreg_sampling&lt; float &gt;</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
